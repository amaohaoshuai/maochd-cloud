var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(t,i,a)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,l=(e,t)=>{for(var i in t||(t={}))o.call(t,i)&&s(e,i,t[i]);if(a)for(var i of a(t))r.call(t,i)&&s(e,i,t[i]);return e};import{_ as n}from"./BaseStencil.46c3d678.js";import{r as p,_ as m}from"./index.ab904951.js";import{b as c}from"./element-plus.b44d97a8.js";import{a as u,s as d}from"./SupplierInvoice.6bf9f95c.js";import{e as b,S as f,B as y,g,j as v,D as h,t as j,L as k,o as w,a5 as C,J as S,w as T}from"./@vue.23a4bd1a.js";import{u as x}from"./vue-router.91336ba9.js";import{d as D}from"./index.6efc7880.js";import{g as I,f as O}from"./filter.c2c8f0b9.js";import{s as B,g as L}from"./businessRule.60794e55.js";import{u as F}from"./vuex.c868d4e0.js";import"./BaseForm.bc55ad6b.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./axios.7b768d2b.js";import"./default-passive-events.74004992.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";function U(e,t,i,a){const o={columns:[{type:"index",title:"序号",formConfig:{width:50},fixed:"left"},{title:"结算单编号",key:"settleNo",width:135},{title:"供应商名称",key:"supplierName",width:176},{title:"门店",key:"business"},{title:"发票号码",key:"invoiceNo",width:124},{title:"发票代码",key:"invoiceCode",width:124},{title:"发票金额",key:"invoiceAmount",width:135,align:"right"},{title:"本次结算金额合计",key:"settleAmount",width:180,align:"right"},{title:"创建人",key:"createUser",width:120},{title:"制单时间",key:"planDate",width:180},{title:"操作",key:"c",width:100,render:(e,t,i,a)=>[b(y("el-button"),{type:"text",onClick:t=>{r(t,"c",e)}},{default:()=>[f("查看")]}),b(y("el-button"),{type:"text",style:"color: #F56C6C",onClick:t=>{s(t,"c",e)}},{default:()=>[f("作废")]})]}]},r=(e,t,i)=>{p.push({name:"SupplierInvoiceDetail",query:{uuid:i.uuid}})},s=(e,i,a)=>{c.confirm("确认作废此发票结算单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:(e,i,o)=>{if("confirm"===e){i.confirmButtonLoading=!0,i.confirmButtonText="执行中...";let e={uuid:a.uuid};u(e).then((e=>{i.confirmButtonLoading=!1,o(),t.value.select()}))}else o()}}).catch((e=>e))};return{form:{inline:!0,labelWidth:"100px",list:[{placeholder:"供应商名称",type:"SELECT",key:"supplierUuid",props:{value:"uuid",label:"supplierName"},list:()=>a.value},{placeholder:"发票号码",type:"INPUT",key:"invoiceNo"},{label:"",type:"SELECT",placeholder:"门店",config:{multiple:!0},key:"businessUuid",props:{label:"name",value:"uuid"},list:()=>i.value},{type:"LINKAGETIME",design:{width:"240px"},keys:["startTime","endTime"],key:"createTime",config:{"start-placeholder":"制单开始时间","end-placeholder":"制单结束时间"}}]},tableConfig:o}}var E={name:"SupplierInvoice",components:{BaseStencil:n},setup(e,s){const n=F(),p=g([]),m=new Date;let c=I(m,30,!0);const u=g(null),{dict:b}=n.state.common,f=x(),y=g([]),k=v({isClear:!1,dict:b,otherData:{},tableData:[],loading:!1,deepSearchTable:U(0,u,p,y),submitForm:{"page.currentPage":1,"page.pageSize":10,startTime:c[0],endTime:O(new Date),businessUuid:[]}}),w=async()=>{k.loading=!0;try{let e=k.submitForm,{businessUuid:t}=e,i=((e,t)=>{var i={};for(var s in e)o.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&a)for(var s of a(e))t.indexOf(s)<0&&r.call(e,s)&&(i[s]=e[s]);return i})(e,["businessUuid"]);t=B(t);let s=l({businessUuid:t},i);const n=await d(s);k.submitForm.pageNumber=n.currentPage,k.tableData=n.list,k.submitForm.total=n.totalElements,k.loading=!1}catch(e){return k.loading=!1,e}};h((()=>{w(),C()}));const C=async()=>{const e=await D();y.value=e,p.value=await n.dispatch("common/mechanism"),L(p.value,k,k.deepSearchTable.form)};return S=l({},j(k)),t(S,i({supplierInvoiceSettleListData:w,addSupplierInvoice:()=>{f.push({name:"AddSupplierInvoice"})},getSupplierListData:C,supplierList:y,form:u,onClick:({item:e,type:t})=>{"dblclick"==t&&f.push({path:"/finance-manage/supplier-invoice-detail",query:{uuid:e.uuid,type:"edit"}})}}));var S}};const N={class:"business-manage"},P=f("新增发票结算单");var _=m(E,[["render",function(e,t,i,a,o,r){const s=y("el-button"),l=n,p=k("loading");return w(),C("div",N,[S(b(l,{"form-data":e.deepSearchTable.form,"submit-form":e.submitForm,"onUpdate:submit-form":t[0]||(t[0]=t=>e.submitForm=t),class:"base-stencil","table-data":e.tableData,columns:e.deepSearchTable.tableConfig.columns,pagination:e.submitForm,draggable:!1,options:!0,"option-show":!1,select:a.supplierInvoiceSettleListData,ref:"form",otherData:e.deepSearchTable.tableConfig.listData,onOnClick:a.onClick,isClear:e.isClear},{buttons:T((()=>[b(s,{style:{"margin-bottom":"10px","margin-right":"3px"},type:"primary",size:"small",onClick:a.addSupplierInvoice},{default:T((()=>[P])),_:1},8,["onClick"])])),_:1},8,["form-data","submit-form","table-data","columns","pagination","select","otherData","onOnClick","isClear"]),[[p,e.loading]])])}],["__scopeId","data-v-908d23de"]]);export{_ as default};
