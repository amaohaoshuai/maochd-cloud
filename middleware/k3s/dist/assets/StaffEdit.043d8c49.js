var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{_ as u}from"./SubmitButton.99d990fd.js";import{_ as d}from"./BaseCard.46de0c24.js";import{_ as i}from"./element-plus.b44d97a8.js";import{u as m}from"./vuex.c868d4e0.js";import{g as n}from"./index.21c3d30d.js";import{g as p}from"./index.b67059af.js";import{e as f,a as b,s as c}from"./index.4d7e135d.js";import{v as _}from"./public.9c1d8f39.js";import{_ as h}from"./index.ab904951.js";import{b as g}from"./vue-router.91336ba9.js";import{_ as D}from"./lodash.d7ab6f48.js";import{g as V,j as v,i as y,n as j,D as S,t as U,B as x,o as L,a5 as q,e as z,w as N,a6 as R,c as C,v as O,F as k,N as E,S as w,z as Y,a9 as B,aa as P}from"./@vue.23a4bd1a.js";import"./resize-observer-polyfill.d4249adb.js";import"./dayjs.bad04745.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./axios.7b768d2b.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";const A={name:"StaffEdit",components:{SubmitButton:u,BaseCard:d},setup(){let e=m();const u=V(null),d=v({submitNum:0,queryUuid:"",isEdit:1,disabled:!1,tabClose:!1,formData:{pharmacist:!1,parentStore:!1,roles:[],auditRoles:[],name:""},storeList:[],characterSelectList:[],approvalRoleSelectList:[],pharmacistList:[{value:!0,label:"是"},{value:!1,label:"否"}],parentStoreList:[{value:!0,label:"是"},{value:!1,label:"否"}],stationList:[],sexList:[]}),h=g(),x=async()=>{d.stationList=["销售员","采购员","验收员","养护员","质管员","处方审核员"],d.sexList=[{label:"男",value:1},{label:"女",value:2}],h.query.uuid?(d.queryUuid=h.query.uuid,c(h.query.uuid).then((e=>{let a=e;if(-1!=a.roles.indexOf("，")){let e=[];e.push(a.roles),a.roles=e}else a.roles=e.roles.split(",");if(-1!=a.auditRoles.indexOf("，")){[].push(a.auditRoles),a.auditRoles=[].push(a.auditRoles)}else a.auditRoles=e.auditRoles.split(",");if(a.station)if(-1!=a.station.indexOf("，")){[].push(a.station),a.station=[].push(a.station)}else a.station=e.station.split(",");0===a.sex&&(a.sex=""),d.formData=e}))):(d.queryUuid=void 0,d.formData={pharmacist:!1,parentStore:!1,roles:[],auditRoles:[]})};return y((()=>d.formData.parentStore),((e,a)=>{e&&(d.formData.businessUuid="")})),j((()=>{(async()=>{d.storeList=await e.dispatch("common/mechanism"),d.storeList.map((e=>{e.value=e.uuid}))})(),(async()=>{n(1).then((e=>{d.characterSelectList=e}))})(),(async()=>{p(1).then((e=>{d.approvalRoleSelectList=e}))})()})),S((()=>{d.isEdit=h.query.isEdit,1==h.query.isEdit?d.disabled=!0:d.disabled=!1,d.queryUuid!==h.query.uuid&&x()})),L=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e})({},U(d)),a(L,l({submitEdit:async()=>{if(await _(u)){let e=JSON.parse(JSON.stringify(d.formData));e.auditRoles=e.auditRoles.toString(),e.roles=e.roles.toString(),e.station&&(e.station=e.station.toString()),h.query.uuid?(e.uuid=h.query.uuid,0==d.submitNum&&f(e).then((e=>{i({type:"success",message:"修改成功!"}),d.tabClose=!0,d.submitNum+=1,setTimeout((()=>{d.submitNum=0}),2e3)}))):0==d.submitNum&&b(e).then((e=>{i({type:"success",message:"添加成功!"}),d.tabClose=!0,d.submitNum+=1,setTimeout((()=>{d.submitNum=0}),2e3)}))}},ruleForm:u,handleStore:e=>{let a=D.find(d.storeList,{storeUuid:d.formData.storeUuid});d.formData.name=a.name},getStaffDetail:x}));var L}},F={class:"staffAdd"},M=(e=>(B("data-v-011c1721"),e=e(),P(),e))((()=>R("span",{style:{"font-size":"16px","font-weight":"600"}}," 员工管理详情 ",-1))),I=w(" 提交 ");var J=h(A,[["render",function(e,a,l,t,s,o){const r=u,i=x("el-input"),m=x("el-form-item"),n=x("el-col"),p=x("el-row"),f=x("el-option"),b=x("el-select"),c=x("el-radio"),_=x("el-radio-group"),h=x("el-date-picker"),g=x("el-form"),D=d;return L(),q("div",F,[z(D,{route:{path:"/system/base-config/staff"},close:e.tabClose,isEdit:e.isEdit},{header:N((()=>[M,R("div",null,[1!=e.isEdit?(L(),C(r,{key:0,class:"btn",onClick:t.submitEdit,config:{size:"small"}},{default:N((()=>[I])),_:1},8,["onClick"])):O("",!0)])])),default:N((()=>[z(g,{inline:"",model:e.formData,ref:"ruleForm","label-width":"120px",class:"demo-ruleForm",disabled:e.disabled},{default:N((()=>[z(p,null,{default:N((()=>[z(n,{span:8},{default:N((()=>[z(m,{size:"small",label:"员工编号",prop:"userNumber",rules:[{required:!0,message:"请输入员工编号",trigger:"blur"}]},{default:N((()=>[z(i,{modelValue:e.formData.userNumber,"onUpdate:modelValue":a[0]||(a[0]=a=>e.formData.userNumber=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"员工账号",size:"small",prop:"userAccount",rules:[{required:!0,message:"请输入员账号",trigger:"blur"}]},{default:N((()=>[z(i,{modelValue:e.formData.userAccount,"onUpdate:modelValue":a[1]||(a[1]=a=>e.formData.userAccount=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"员工姓名",size:"small",prop:"userName",rules:[{required:!0,message:"请输员工姓名",trigger:"blur"}]},{default:N((()=>[z(i,{modelValue:e.formData.userName,"onUpdate:modelValue":a[2]||(a[2]=a=>e.formData.userName=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),z(p,null,{default:N((()=>[z(n,{span:8},{default:N((()=>[z(m,{label:"手机号",size:"small",prop:"phone",rules:[{required:!0,message:"请输手机号",trigger:"blur"},{trigger:"blur",pattern:/^(\+86|0086)?\s*1[345789]\d{9}$/,message:"请输入正确的手机号码"}]},{default:N((()=>[z(i,{modelValue:e.formData.phone,"onUpdate:modelValue":a[3]||(a[3]=a=>e.formData.phone=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"岗位"},{default:N((()=>[z(b,{modelValue:e.formData.station,"onUpdate:modelValue":a[4]||(a[4]=a=>e.formData.station=a),placeholder:"请选择",multiple:""},{default:N((()=>[(L(!0),q(k,null,E(e.stationList,((e,a)=>(L(),C(f,{label:e,value:e,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"是否药师",prop:"pharmacist",rules:[{required:!0,message:"请选择是否药师",trigger:"change"}]},{default:N((()=>[z(_,{modelValue:e.formData.pharmacist,"onUpdate:modelValue":a[5]||(a[5]=a=>e.formData.pharmacist=a)},{default:N((()=>[(L(!0),q(k,null,E(e.pharmacistList,((e,a)=>(L(),C(c,{label:e.value,key:a},{default:N((()=>[w(Y(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),z(p,null,{default:N((()=>[z(n,{span:8},{default:N((()=>[z(m,{label:"系统角色",size:"small",prop:"roles",rules:[{required:!0,message:"请选择系统角色",trigger:"blur"}]},{default:N((()=>[z(b,{modelValue:e.formData.roles,"onUpdate:modelValue":a[6]||(a[6]=a=>e.formData.roles=a),placeholder:"请选择",multiple:""},{default:N((()=>[(L(!0),q(k,null,E(e.characterSelectList,((e,a)=>(L(),C(f,{label:e.roleName,value:e.uuid,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"审批角色",size:"small",prop:"auditRoles"},{default:N((()=>[z(b,{modelValue:e.formData.auditRoles,"onUpdate:modelValue":a[7]||(a[7]=a=>e.formData.auditRoles=a),placeholder:"请选择",multiple:""},{default:N((()=>[(L(!0),q(k,null,E(e.approvalRoleSelectList,((e,a)=>(L(),C(f,{label:e.auditRoleName,value:e.uuid,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"是否总部",prop:"parentStore",rules:[{required:!0,message:"请选择是否总部",trigger:"change"}]},{default:N((()=>[z(_,{modelValue:e.formData.parentStore,"onUpdate:modelValue":a[8]||(a[8]=a=>e.formData.parentStore=a)},{default:N((()=>[(L(!0),q(k,null,E(e.pharmacistList,((e,a)=>(L(),C(c,{label:e.value,key:a},{default:N((()=>[w(Y(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),z(p,null,{default:N((()=>[z(n,{span:8}),z(n,{span:8}),z(n,{span:8})])),_:1}),z(p,null,{default:N((()=>[z(n,{span:8},{default:N((()=>[z(m,{label:"门店",size:"small",prop:"businessUuid",rules:[{required:!e.formData.parentStore,message:"请选择门店",trigger:"blur"}]},{default:N((()=>[z(b,{onChange:t.handleStore,modelValue:e.formData.businessUuid,"onUpdate:modelValue":a[9]||(a[9]=a=>e.formData.businessUuid=a),placeholder:"请选择",disabled:!!e.formData.parentStore},{default:N((()=>[(L(!0),q(k,null,E(e.storeList,((e,a)=>(L(),C(f,{label:e.name,value:e.uuid,key:a},null,8,["label","value"])))),128))])),_:1},8,["onChange","modelValue","disabled"])])),_:1},8,["rules"])])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"身份证号",size:"small",prop:"idCard",rules:[{trigger:"blur",pattern:/^[1-9]\d{5}(18|19|20|(3\d))\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,message:"请输入正确的身份证号"}]},{default:N((()=>[z(i,{modelValue:e.formData.idCard,"onUpdate:modelValue":a[10]||(a[10]=a=>e.formData.idCard=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"性别",size:"small",prop:"sex"},{default:N((()=>[z(b,{modelValue:e.formData.sex,"onUpdate:modelValue":a[11]||(a[11]=a=>e.formData.sex=a),placeholder:"请选择"},{default:N((()=>[(L(!0),q(k,null,E(e.sexList,((e,a)=>(L(),C(f,{label:e.label,value:e.value,key:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),z(p,null,{default:N((()=>[z(n,{span:8},{default:N((()=>[z(m,{prop:"kk",size:"small",label:"身份证有效期"},{default:N((()=>[z(h,{modelValue:e.formData.idCardValidity,"onUpdate:modelValue":a[12]||(a[12]=a=>e.formData.idCardValidity=a),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",type:"date",placeholder:"选择日期"},null,8,["modelValue"])])),_:1})])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"职称",size:"small",prop:"professional"},{default:N((()=>[z(i,{modelValue:e.formData.professional,"onUpdate:modelValue":a[13]||(a[13]=a=>e.formData.professional=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1}),z(n,{span:8},{default:N((()=>[z(m,{label:"职务",size:"small",prop:"position"},{default:N((()=>[z(i,{modelValue:e.formData.position,"onUpdate:modelValue":a[14]||(a[14]=a=>e.formData.position=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),z(p,null,{default:N((()=>[z(n,{span:8},{default:N((()=>[z(m,{label:"最高学历",size:"small",prop:"education"},{default:N((()=>[z(i,{modelValue:e.formData.education,"onUpdate:modelValue":a[15]||(a[15]=a=>e.formData.education=a),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","disabled"])])),_:1},8,["close","isEdit"])])}],["__scopeId","data-v-011c1721"]]);export{J as default};
