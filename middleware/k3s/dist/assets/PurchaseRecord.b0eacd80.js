var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s,l=(e,t)=>{for(var i in t||(t={}))r.call(t,i)&&o(e,i,t[i]);if(s)for(var i of s(t))a.call(t,i)&&o(e,i,t[i]);return e},n=(e,s)=>t(e,i(s)),m=(e,t)=>{var i={};for(var o in e)r.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&s)for(var o of s(e))t.indexOf(o)<0&&a.call(e,o)&&(i[o]=e[o]);return i};import{_ as d}from"./BaseStencil.46c3d678.js";import{_ as p}from"./BaseName.1aa32b4b.js";import{G as u,g as b,j as c,D as f,t as g,B as j,o as h,a5 as y,e as v,w,S as x}from"./@vue.23a4bd1a.js";import{d as k}from"./index.7c4fa9df.js";import{u as U}from"./vuex.c868d4e0.js";import{g as S}from"./index.f5db11a4.js";import{g as F,f as P}from"./filter.c2c8f0b9.js";import{s as C,g as L}from"./businessRule.60794e55.js";import{_ as O}from"./index.ab904951.js";import"./BaseForm.bc55ad6b.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./vue-router.91336ba9.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";/* empty css                                                             */import"./axios.7b768d2b.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./element-plus.b44d97a8.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";function D(e,t,i){return{form:{inline:!0,labelWidth:"100px",list:[{label:"",type:"INPUT",key:"productInfo",placeholder:"请输入商品信息"},{label:"",type:"SELECT",placeholder:"请选择门店",key:"businessUuid",props:{label:"name",value:"uuid"},list:()=>t.value,config:{multiple:!0}},{label:"",type:"LINKAGETIME",keys:["timeStart","timeEnd"],design:{width:"240px"},config:{"start-placeholder":"制单开始时间","end-placeholder":"制单结束时间"},key:""}]},tableConfig:{columns:[{title:"序号",key:"",type:"index",formConfig:{width:50},fixed:"left"},{title:"商品名称/规格/单位/生产厂家",key:"",fixed:"left",formConfig:{"show-overflow-tooltip":!1,"min-width":210},render:e=>u(p,{row:e})},{title:"剂型",key:"dosageForm",width:100},{title:"采购数量",key:"purchaseNum",align:"right",width:110},{title:"含税进价",key:"taxPaid",align:"right",width:110},{title:"含税金额",key:"taxAmount",align:"right",width:110},{title:"批准文号",key:"approvalNumber",width:224},{title:"上市许可持有人",key:"holderPermit",width:140},{title:"供应商名称",key:"supplierName",width:176},{title:"门店",key:"business",width:100},{title:"创建人",key:"createUser",width:76},{title:"制单时间",key:"planDate",width:110}]}}}var _={name:"PurchaseRecord",setup(e,t){const i=U(),s=new Date;let r=F(s,30,!0);b(null);const a=b([]),o=c({storeList:[],isClear:!1,loading:!1,tableData:[],deepSearchTable:D(0,a),submitForm:{"page.currentPage":1,"page.pageSize":10,timeStart:r[0],timeEnd:P(new Date),productInfo:"",businessUuid:[]},columns:[]}),d=()=>{o.loading=!0;let e=o.submitForm,{businessUuid:t}=e,i=m(e,["businessUuid"]);t=C(t);let s=l({businessUuid:t},i);S(s).then((e=>{o.submitForm.currentPage=e.currentPage,o.submitForm.pageSize=e.pageSize,o.tableData=e.records;for(let t=0;t<e.records.length;t++)o.tableData[t].name=e.records[t].productName,o.tableData[t].drugUuid=e.records[t].uuid;o.submitForm.total=e.total,o.loading=!1}))};return f((async()=>{o.storeList=await i.dispatch("common/mechanism"),a.value=o.storeList,L(o.storeList,o,o.deepSearchTable.form),d()})),n(l({},g(o)),{getList:d,findList:a,exportExcel:async()=>{let{storeUuid:e}=i.state.common.info,t=o.submitForm,{businessUuid:s}=t,r=m(t,["businessUuid"]),a={};a=0==o.submitForm.businessUuid.length?l({businessUuid:o.storeList.map((e=>e.uuid)).join(",")},r):o.submitForm;let d=k("/gateway/chain-store/procure/procureListGsp",n(l({},a),{storeUuid:e}));window.open(d,"_self")}})}};const E={class:"supplier"},T=x(" 导出 ");var z=O(_,[["render",function(e,t,i,s,r,a){const o=j("el-button"),l=d;return h(),y("div",E,[v(l,{"form-data":e.deepSearchTable.form,"submit-form":e.submitForm,"onUpdate:submit-form":t[0]||(t[0]=t=>e.submitForm=t),class:"base-stencil","table-data":e.tableData,columns:e.deepSearchTable.tableConfig.columns,pagination:e.submitForm,options:!0,optionShow:!1,ref:"form",select:s.getList,loading:e.loading,isClear:e.isClear},{buttons:w((()=>[v(o,{style:{"margin-bottom":"10px"},size:"small",plain:"",type:"primary",onClick:s.exportExcel},{default:w((()=>[T])),_:1},8,["onClick"])])),_:1},8,["form-data","submit-form","table-data","columns","pagination","select","loading","isClear"])])}],["__scopeId","data-v-70001d03"]]);export{z as default};
