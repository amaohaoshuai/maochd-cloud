var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,l=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&r(e,a,t[a]);if(i)for(var a of i(t))o.call(t,a)&&r(e,a,t[a]);return e},n=(e,i)=>t(e,a(i));import{_ as m}from"./BaseStencil.46c3d678.js";import{_ as d}from"./BaseName.1aa32b4b.js";import{G as p,g as c,j as u,D as b,t as f,B as y,o as h,a5 as j,e as g,w,S as v}from"./@vue.23a4bd1a.js";import{s as k,_ as T}from"./index.ab904951.js";import{u as x}from"./vue-router.91336ba9.js";import{a as C}from"./axios.7b768d2b.js";import{g as U,f as S}from"./filter.c2c8f0b9.js";import{d as F}from"./index.7c4fa9df.js";import{s as E,g as O}from"./businessRule.60794e55.js";import"./BaseForm.bc55ad6b.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./vuex.c868d4e0.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";/* empty css                                                             */import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./element-plus.b44d97a8.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";function D(e,t,a,i){return{form:{inline:!0,labelWidth:"100px",list:[{placeholder:"请输入商品信息",type:"INPUT",key:"productInfo"},{placeholder:"请选择门店",type:"SELECT",props:{label:"name",value:"uuid"},list:()=>t.value,key:"businessUuid",config:{multiple:!0}},{placeholder:"请选择养护类型",type:"SELECT",key:"mteType",list:()=>[{label:"一般养护",value:1},{label:"重点养护",value:2},{label:"近效期养护",value:3}]},{type:"LINKAGETIME",keys:["startTime","endTime"],design:{width:"220px"},config:{"start-placeholder":"开始时间","end-placeholder":"结束时间"},key:""}]},tableConfig:{columns:[{title:"序号",type:"index",fixed:"left",formConfig:{width:50}},{title:"商品名称/规格/单位/生产厂家",key:"productName",fixed:"left",formConfig:{"show-overflow-tooltip":!1,"min-width":210},render:e=>p(d,{row:e})},{title:"剂型",key:"dosageForm",width:80},{title:"批号",key:"batchNumber",width:178},{title:"有效期至",key:"expireDate",width:110},{title:"库存数量",key:"stockQuantity",align:"right",width:100},{title:"质量状况",key:"qualityState",width:100},{title:"储存条件",key:"condition",width:100},{title:"包装情况",key:"packingCondition",width:100},{title:"质量问题",key:"qualityProblem",width:100},{title:"处理方法",key:"processMethod",width:100},{title:"养护人",key:"maintenancePeople",width:100},{title:"养护类型",key:"mteType",width:100},{title:"任务编号",key:"taskNo",width:178},{title:"养护日期",key:"createTime",width:110},{title:"门店",key:"business",width:100}]}}}var P={name:"MaintenanceRecord",setup(e,t){const a=new Date;let r=U(a,30,!0);x(),c(null);const m=c([]);u({qualityState:{0:"不合格",1:"合格"},curingType:{0:"待养护",1:"已养护"},storageConditions:{1:"常温",2:"阴凉",3:"冷藏"},mteType:{1:"一般养护",2:"重点养护",3:"近效期养护"}});const d=u({isClear:!1,loading:!0,tableData:[],excelUrl:"",deepSearchTable:D(0,m),submitForm:{"page.currentPage":1,"page.pageSize":10,productInfo:"",mteType:"",businessUuid:[],startTime:r[0],endTime:S(new Date),mechanism:[]},columns:[]});b((async()=>{await p(),y()}));const p=async()=>{let{storeUuid:e}=k.state.common.info;d.submitForm.storeUuid=e,m.value=await k.dispatch("common/mechanism"),O(m.value,d,d.deepSearchTable.form)},y=async()=>{let e=d.submitForm,{businessUuid:t}=e,a=((e,t)=>{var a={};for(var r in e)s.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&o.call(e,r)&&(a[r]=e[r]);return a})(e,["businessUuid"]);t=E(t),function(e){return C.get("/gateway/chain-store/record/findRecordPage",{params:e})}(l({businessUuid:t},a)).then((e=>{d.loading=!1,d.submitForm.total=e.totalCount,e.list.forEach((e=>{e.name=e.productName})),d.tableData=e.list})).catch((e=>{}))};return n(l({},f(d)),{getTableData:y,exportExcel:async()=>{let{storeUuid:e}=k.state.common.info,t=await k.dispatch("common/mechanism"),a="";a=d.submitForm.businessUuid.length?E(d.submitForm.businessUuid):t.map((e=>e.uuid)).join(",");let i=F("/gateway/chain-store/record/exportExcelCuringRecord",n(l({},d.submitForm),{storeUuid:e,businessUuid:a}));window.open(i,"_self")}})}};const _={class:"supplier"},N=v(" 导出 ");var I=T(P,[["render",function(e,t,a,i,s,o){const r=y("el-button"),l=m;return h(),j("div",_,[g(l,{"form-data":e.deepSearchTable.form,"submit-form":e.submitForm,"onUpdate:submit-form":t[0]||(t[0]=t=>e.submitForm=t),class:"base-stencil","table-data":e.tableData,columns:e.deepSearchTable.tableConfig.columns,pagination:e.submitForm,options:!0,optionShow:!1,select:i.getTableData,ref:"form",loading:e.loading,isClear:e.isClear},{buttons:w((()=>[g(r,{class:"retail-details-btn",plain:"",type:"primary",size:"small",onClick:i.exportExcel},{default:w((()=>[N])),_:1},8,["onClick"])])),_:1},8,["form-data","submit-form","table-data","columns","pagination","select","loading","isClear"])])}],["__scopeId","data-v-6a8278b3"]]);export{I as default};
