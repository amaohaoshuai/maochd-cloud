var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,s=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&r(e,a,t[a]);if(i)for(var a of i(t))l.call(t,a)&&r(e,a,t[a]);return e};import{_ as u}from"./SubmitButton.99d990fd.js";import{_ as n}from"./EditForm.8c35f1a6.js";import{_ as d}from"./BaseTable.36f55649.js";import{_ as m}from"./BaseCard.46de0c24.js";import{_ as c}from"./BaseName.1aa32b4b.js";import{b as p}from"./vue-router.91336ba9.js";import{u as b}from"./vuex.c868d4e0.js";import{b as f}from"./BatchNumber.b846d4bb.js";import{_ as y}from"./lodash.d7ab6f48.js";import{_ as h}from"./element-plus.b44d97a8.js";import{e as g,b as w,c as v}from"./CuringTask.23b43602.js";import{g as k,j,e as S,B as C,Y as q,D as x,t as D,q as N,o as T,c as U,w as F,a6 as _,S as I,z as O,J as P,Q as z,a9 as V,aa as L}from"./@vue.23a4bd1a.js";import{_ as B}from"./index.ab904951.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./sortablejs.621e50ab.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./public.9c1d8f39.js";/* empty css                                                             */import"./axios.7b768d2b.js";import"./dayjs.bad04745.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";function E(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!q(e)}var A={name:"ConfirmCuringTask",setup(){const e=k(null),i=k(null);let o=p(),l=b(),r=j({status:!1,otherConfig:{},batchObject:{productUuid:"",batchNum:""},selectArr:[],top:{"margin-top":"5px"},design:{width:"220px",height:"36px"},isDisable:!1,qualityStateList:[{value:0,label:"不合格"},{value:1,label:"合格"}],curingType:{0:"待养护",1:"已养护"},storageConditions:{1:"常温",2:"阴凉",3:"冷藏"},barchWidth:{width:"160px"},mteType:{1:"一般养护",2:"重点养护",3:"近效期养护"}}),u=j({formConfig:{rowKey:e=>e.uuid},uuid:o.query.uuid,submitForm:{"page.currentPage":1,"page.pageSize":10},optionShow:!1,multipleSelectionList:[],index:0,editForm:null,editForm1:null,keyBoard:null,selectParams:{orderUuid:"",fuzzyValue:""},close:!1,go:{path:"/quality/curing-manage/curing-task"},config:{size:"small"},text:"新增",pot:-1,query:{},formInfo:{labelWidth:"110px",span:8,list:[{label:"任务编号：",type:"DIV",key:"taskNo"},{label:"任务名称：",type:"DIV",key:"taskName"},{label:"门店：",type:"DIV",key:"business"},{label:"养护类型：",type:"DIV",key:"mteType"},{label:"任务生成时间：",type:"DIV",key:"createTime"},{label:"养护排序：",type:"DIV",key:"sortCode"},{label:"商品类型：",type:"DIV",key:"productCategory"},{label:"备注：",type:"DIV",key:"remark"}]},info:{creator:l.state.common.info.userName},otherColumns:[{type:"selection",fixed:"left",formConfig:{reserveSelection:!0,selectable:e=>y.findIndex(u.data,{uuid:e.uuid})<0},width:42},{title:"序号",type:"index",formConfig:{width:50}},{title:"商品编码",key:"code",width:150},{title:"商品名称",key:"name",width:180,formConfig:{"show-overflow-tooltip":!1},render:e=>S(c,{row:e},null)},{title:"批号",key:"batchNum",width:150},{title:"生产日期",key:"producedTime",width:150},{title:"有效期至",key:"indate",width:150,align:"right"},{title:"整装库存数量",key:"overallPackNum",width:150,align:"right"},{title:"拆零库存数量",key:"deleavePackNum",width:150,align:"right"},{title:"质量状况",key:"qualityState",width:200,formConfig:{"show-overflow-tooltip":!1},render:(e,t,a,i)=>{let o;return S(C("el-select"),{size:"medium",class:e[`qualityState_${i}`],modelValue:e.qualityState,placeholder:"请选择",onChange:t=>{n(e,"qualityState",t)}},E(o=r.qualityStateList.map((e=>S(C("el-option"),{key:e.value,label:e.label,value:e.value},null))))?o:{default:()=>[o]})}},{title:"存储条件",key:"condition",width:150,render:e=>S("div",null,[r.storageConditions[e.condition]])},{title:"养护状态",key:"state",width:150,render:e=>S("div",null,[r.curingType[e.state]])},{title:"批准文号",key:"approvalNumber",width:150},{title:"生产许可证持有人",key:"holderPermit",width:150}],allColumns:[{type:"selection",fixed:"left",formConfig:{reserveSelection:!0},width:42},{title:"序号",type:"index",formConfig:{width:50}},{title:"商品编码",key:"code",width:150},{title:"商品名称",key:"name",width:180,formConfig:{"show-overflow-tooltip":!1},render:e=>S(c,{row:e},null)},{title:"批号",key:"batchNum",width:150},{title:"生产日期",key:"producedTime",width:150},{title:"有效期至",key:"indate",width:150},{title:"整装库存数量",key:"overallPackNum",width:150,align:"right"},{title:"拆零库存数量",key:"deleavePackNum",width:150,align:"right"},{title:"质量状况",key:"qualityState",width:200,formConfig:{"show-overflow-tooltip":!1},render:(e,t,a,i)=>{let o;return S(C("el-select"),{size:"medium",class:e[`qualityState_${i}`],modelValue:e.qualityState,placeholder:"请选择",onChange:t=>{n(e,"qualityState",t)}},E(o=r.qualityStateList.map((e=>S(C("el-option"),{key:e.value,label:e.label,value:e.value},null))))?o:{default:()=>[o]})}},{title:"存储条件",key:"condition",width:150,render:e=>S("div",null,[r.storageConditions[e.condition]])},{title:"养护状态",key:"state",width:150,render:e=>S("div",null,[r.curingType[e.state]])},{title:"批准文号",key:"approvalNumber",width:150},{title:"生产许可证持有人",key:"holderPermit",width:150}],data:[]});const n=(e,t,a,i)=>{e[t]=a},d=async e=>{let t={uuid:e};const a=await w(t);u.info=a,u.info.mteType=r.mteType[u.info.mteType],u.info.productCategory=u.info.productCategory.join(",")},m=async()=>{try{document.querySelectorAll("input[type='checkbox']").forEach((e=>{r.status?e.disabled=!0:e.disabled=!1})),u.submitForm.taskUuid=o.query.uuid,u.submitForm.sortCode="code";const t=await v(u.submitForm);u.submitForm.total=t.totalElements,u.submitForm.pageNumber=t.currentPage,t.list.map((e=>{e.name=e.productName})),u.data=t.list;let a=JSON.parse(JSON.stringify(u.data));N((()=>{r.status&&a.forEach((t=>{e.value.allSelect(t,!0)}))}))}catch(t){return t}};x((()=>{let{query:e}=o;u.text=e.uuid?"编辑":"新增",u.query.uuid!==e.uuid&&(e.uuid?(d(e.uuid),m(e.uuid)):(u.info={},u.data=[],u.selectParams.orderUuid=""),u.query=y.cloneDeep(e))}));const q=()=>{r.status=!r.status,r.status?N((()=>{u.data.forEach((t=>{e.value.allSelect(t,!0)}))})):N((()=>{e.value.cancelSelect()}));document.querySelectorAll("input[type='checkbox']").forEach((e=>{r.status?e.disabled=!0:e.disabled=!1}))};return T=s(s({},D(u)),D(r)),t(T,a({getDetail:d,getDetailListData:m,handleInput:async e=>{let{selectParams:t}=u;t.fuzzyValue=e;let a={invincible:e};const i=(await f(a)).map((e=>{let t=e.info;return t.name=e.info.productName,t.productUuid=e.productUuid,t.drugUuid=e.productUuid,t.businessUuid=e.businessUuid,t.onlyUuid=e.businessUuid+e.productUuid,t}));r.selectArr=i},handleChange:e=>{u.data.push(y.cloneDeep(e)),u.pot=u.data.length-1,r.batchObject.productUuid=e.productUuid,r.selectArr=[]},handleSubmit:async e=>{if(!r.status&&0==u.multipleSelectionList.length)return void h.warning("请选择商品");let t={maintenanceTaskDetailList:u.multipleSelectionList,taskUuid:r.status?o.query.uuid:"",status:r.status?0:1};await g(t),u.close=!0},allSelet:e=>{0!==u.data.length?q():h.warning("暂无商品信息")},baseTable:e,batchHandleInput:async e=>{r.batchObject.batchNum=e},multipleSelection:e=>{u.multipleSelectionList=e},allSelectFun:q,baseTables:i}));var T}};const J=(e=>(V("data-v-401e3572"),e=e(),L(),e))((()=>_("div",{class:"title"},"养护任务详情",-1))),H=I(" 养护通过 "),W={class:"top-content"},$={class:"main"};var K=B(A,[["render",function(e,t,a,i,o,l){const r=u,s=n,c=C("el-button"),p=d,b=C("el-scrollbar"),f=m;return T(),U(f,{close:e.close,route:e.go,"t-id":"tab"},{header:F((()=>[J,_("div",null,[S(r,{config:e.config,onClick:t[0]||(t[0]=e=>i.handleSubmit(""))},{default:F((()=>[H])),_:1},8,["config"])])])),default:F((()=>[_("div",W,[S(s,{"form-data":e.formInfo,"onUpdate:form-data":t[1]||(t[1]=t=>e.formInfo=t),"submit-form":e.info,"onUpdate:submit-form":t[2]||(t[2]=t=>e.info=t),ref:"editForm"},null,8,["form-data","submit-form"])]),_("div",$,[S(b,{style:{height:"100%"}},{default:F((()=>[_("div",null,[S(c,{style:{"margin-bottom":"10px"},type:"primary",size:"small",onClick:t[3]||(t[3]=t=>i.allSelet(e.uuid))},{default:F((()=>[I(O(e.status?"取消全选":"全选"),1)])),_:1})]),P(S(p,{class:"select-table",columns:e.allColumns,"table-data":e.data,optionShow:e.optionShow,multipleSelection:i.multipleSelection,ref:"baseTable","class-id":"tab","reduce-num":250,pagination:e.submitForm,"submit-form":e.submitForm,"onUpdate:submit-form":t[4]||(t[4]=t=>e.submitForm=t),formConfig:e.formConfig,select:i.getDetailListData},null,8,["columns","table-data","optionShow","multipleSelection","pagination","submit-form","formConfig","select"]),[[z,!e.status]]),P(S(p,{class:"select-table",columns:e.otherColumns,"table-data":e.data,optionShow:e.optionShow,multipleSelection:i.multipleSelection,ref:"baseTable","class-id":"tab","reduce-num":250,pagination:e.submitForm,"submit-form":e.submitForm,"onUpdate:submit-form":t[5]||(t[5]=t=>e.submitForm=t),formConfig:e.formConfig,select:i.getDetailListData},null,8,["columns","table-data","optionShow","multipleSelection","pagination","submit-form","formConfig","select"]),[[z,e.status]])])),_:1})])])),_:1},8,["close","route"])}],["__scopeId","data-v-401e3572"]]);export{K as default};
