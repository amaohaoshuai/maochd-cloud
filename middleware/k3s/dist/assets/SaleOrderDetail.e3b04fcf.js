var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i;import{_ as s}from"./EditForm.8c35f1a6.js";import{_ as n}from"./BaseTable.36f55649.js";import{_ as p}from"./BaseCard.46de0c24.js";import{_ as m}from"./BaseName.1aa32b4b.js";import{j as d,J as f,Q as y,e as c,S as b,D as u,t as h,B as k,o as I,c as g,w as v,a5 as D,a6 as V,v as w,a9 as j,aa as x}from"./@vue.23a4bd1a.js";import{b as P}from"./vue-router.91336ba9.js";import{d as N,e as S}from"./index.3778ab26.js";import{u as U}from"./vuex.c868d4e0.js";import"./lodash.d7ab6f48.js";import"./element-plus.b44d97a8.js";import{_ as E}from"./index.ab904951.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./sortablejs.621e50ab.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./public.9c1d8f39.js";/* empty css                                                             */import"./dayjs.bad04745.js";import"./axios.7b768d2b.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";var M={name:"SaleOrderDetail",setup(){let e=P();U();let s=d({close:!1,go:{path:"/retail/sale-order"},formInfo1:{labelWidth:"120px",span:6,list:[{label:"销售单号：",type:"DIV",key:"orderNo"},{label:"订单类型：",type:"DIV",key:"orderType"},{label:"订单来源：",type:"DIV",key:"orderSource"},{label:"门店：",type:"DIV",key:"business"},{label:"会员姓名：",type:"DIV",key:"customerName"},{label:"会员手机号：",type:"DIV",key:"customerPhone"},{label:"收银员：",type:"DIV",key:"employName"},{label:"销售员：",type:"DIV",key:"sellName"},{label:"是否含处方：",type:"TEMP",key:"hasEthical",render:()=>0===s.info.hasEthical||null===s.info.hasEthical?"否":"是"},{label:"是否含特殊制剂：",type:"TEMP",key:"hasSpecial",render:()=>0===s.info.hasSpecial||null===s.info.hasSpecial?"否":"是"}]},formInfo2:{labelWidth:"120px",span:6,list:[{label:"应收金额：",type:"TEMP",key:"orderAmount",render:()=>s.info.orderAmount+"元"},{label:"实收金额：",type:"TEMP",key:"payAmount",render:()=>f(c("div",null,[s.info.count||0,b("元（"),s.info.payInfos.map(((e,t)=>c("span",null,[e.payTypeName,b(":"),e.payMoney+"元",f(c("span",null,[b("、")]),[[y,s.info.payInfos.length>1&&t<s.info.payInfos.length-1]])]))),b("）")]),[[y,s.info.payInfos&&s.info.payInfos.length>0]])},{label:"优惠金额：",type:"TEMP",key:"discountAmount",render:()=>s.info.discountAmount+"元"},{label:"抹零金额：",type:"TEMP",key:"roundMoney",render:()=>s.info.roundMoney+"元"}]},prescriptionForm:{base:{labelWidth:"80px",span:6,list:[{label:"医疗机构：",type:"DIV",key:"medicalEstablishment"},{label:"科室：",type:"DIV",key:"department"},{label:"医师：",type:"DIV",key:"physician"},{label:"临床诊断：",type:"DIV",key:"diagnosis"}]},patient:{labelWidth:"80px",span:6,list:[{label:"姓名：",type:"DIV",key:"patientName"},{label:"性别：",type:"DIV",key:"sex"},{label:"年龄：",type:"DIV",key:"age"},{label:"联系电话：",type:"DIV",key:"tel"},{label:"身份证号：",type:"DIV",key:"idNumber"},{label:"地址：",type:"DIV",key:"address"},{label:"过敏史：",type:"DIV",key:"allergyHistory"},{label:"体重：",type:"DIV",key:"weight"}]},remark:{labelWidth:"80px",span:6,list:[{label:"审核人：",type:"DIV",key:"auditor"},{label:"配药人：",type:"DIV",key:"dispenser"},{label:"核对人：",type:"DIV",key:"checker"}]}},prescriptionInfo:{prescriptionSource:{},patientJson:{},approvalJson:{}},specialInfo:{patientJson:{}},specialForm:{labelWidth:"80px",span:6,list:[{label:"姓名：",type:"DIV",key:"patientName"},{label:"性别：",type:"DIV",key:"sex"},{label:"年龄：",type:"DIV",key:"age"},{label:"联系电话：",type:"DIV",key:"tel"},{label:"身份证号：",type:"DIV",key:"idNumber"},{label:"地址：",type:"DIV",key:"address"},{label:"过敏史：",type:"DIV",key:"allergyHistory"},{label:"体重：",type:"DIV",key:"weight"},{label:"备注：",type:"DIV",key:"note"}]},info:{count:0,payInfos:[]},columns:[{title:"序号",type:"index",formConfig:{width:50},fixed:"left"},{title:"商品编码",key:"code",width:150,fixed:"left"},{title:"商品名称",render:e=>c(m,{row:e},null),fixed:"left"},{title:"批号",key:"batchNumber",width:200},{title:"有效期至",key:"expireDate",width:220},{title:"销售数量",key:"num",width:100,render:e=>e.num+e.unit},{title:"实价",key:"payPrice",width:100,align:"right"},{title:"小计",key:"subtotal",width:100,align:"right"},{title:"成本进价",key:"overallPackPrice",width:100,align:"right"},{title:"零售价",key:"sellingPrice",width:100,align:"right"},{title:"会员价",key:"memberPrice",width:100,align:"right"},{title:"是否处方",key:"ethical",width:120,render:e=>e.ethical&&null!==e.ethical?"是":"否"},{title:"是否特殊制剂",key:"isSpecial",width:120,render:e=>e.isSpecial&&null!==e.isSpecial?"是":"否"}],goodsData:[],formInfo1_Yb:{labelWidth:"120px",span:6,list:[{label:"销售单号：",type:"DIV",key:"orderNo"},{label:"交易流水号：",type:"DIV",key:"tradeSerialNo"},{label:"制单时间：",type:"DIV",key:"createTime"},{label:"客户姓名：",type:"DIV",key:"accountName"},{label:"性别：",type:"TEMP",key:"sex",render:e=>{let{sex:t}=e;return c("div",null,["1"===t?"男":"女"])}},{label:"医保号：",type:"DIV",key:"medicalNo"},{label:"年龄：",type:"DIV",key:"age"},{label:"会员名称：",type:"DIV",key:"customerName"},{label:"手机号：",type:"DIV",key:"customerPhone"},{label:"处方号：",type:"DIV",key:"prescNo"},{label:"就诊号：",type:"DIV",key:"visitNo"},{label:"处方医院：",type:"DIV",key:"hospitalNo"},{label:"处方日期：",type:"DIV",key:"prescDate"},{label:"医嘱：",type:"DIV",key:"diagnosis",span:24}]},formInfo2_Yb:{labelWidth:"120px",span:6,list:[{label:"费用总额：",type:"TEMP",key:"totalMoney",render:()=>s.info.totalMoney+"元"},{label:"医保支付：",type:"TEMP",key:"accountPayAmount",render:()=>(1e3*s.info.totalMoney-1e3*s.info.cashPay)/1e3+"元"},{label:"个人支付：",type:"TEMP",key:"cashPay",render:()=>c("div",null,[s.info.cashPay||0,b("元"),f(c("span",null,[b("（"),s.info.payInfos.map(((e,t)=>c("span",null,[e.payTypeName,b(":"),e.payMoney+"元",f(c("span",null,[b("、")]),[[y,s.info.payInfos.length>1&&t<s.info.payInfos.length-1]])]))),b("）")]),[[y,s.info.payInfos&&s.info.payInfos.length>0]])])}]},columns_Yb:[{title:"序号",type:"index",formConfig:{width:50},fixed:"left"},{title:"医保编码",key:"insuranceCode",width:150,fixed:"left"},{title:"商品名称",width:300,render:e=>c(m,{row:e},null),fixed:"left"},{title:"批号",key:"batchNumber",width:200},{title:"有效期至",key:"expireDate",width:220},{title:"销售数量",key:"num",width:100,render:e=>e.num+e.unit},{title:"贴数",key:"pasteNumber",width:70},{title:"零售价",key:"sellingPrice",width:100,align:"right"},{title:"金额",key:"subtotal",width:100,align:"right"},{title:"是否处方",key:"ethical",width:120,render:e=>e.ethical&&null!==e.ethical?"是":"否"},{title:"分类",key:"prescriptionClass",width:100},{title:"限制标志",key:"restrictedUseSign",width:100,render:e=>{switch(e.restrictedUseSign){case 0:return"无要求";case 1:return"不符合限用规定";case 2:return"符合限用规定";case 3:return"强制自费"}}},{title:"限制范围",key:"productLimitScope",width:160},{title:"加价支付标准",key:"markupPrice",width:120,align:"right",render:e=>e.markupPrice&&99999!=e.markupPrice&&999999!=e.markupPrice&&99999999!=e.markupPrice&&999999999!=e.markupPrice&&100000199!=e.markupPrice?e.markupPrice:"-"},{title:"用量单位",key:"unitName",width:100},{title:"每次用量",key:"eachTime",width:100},{title:"用法标准",key:"useStandName",width:100},{title:"执行周期",key:"execCycle",width:100}]});const n=async(t,a)=>{let{query:i}=e;"YB"===i.type?N({orderUuid:t,orderState:a}).then((e=>{s.info=e,e.productVos.forEach((e=>{e.name=e.productName}));let t=0;s.info.payInfos.length>0&&s.info.payInfos.map((e=>{t=(1e3*t+1e3*e.payMoney)/1e3})),s.info.payInfos=e.payInfos,s.info.count=t,s.goodsData=e.productVos})):S({orderUuid:t,orderState:a}).then((e=>{s.info=e,s.payInfos=e.payInfos,s.prescriptionInfo=Object.assign(s.prescriptionInfo,e.prescriptionInfo);let t=0;s.info.payInfos.length>0&&s.info.payInfos.map((e=>{t=(1e3*t+1e3*e.payMoney)/1e3})),s.info.count=t,s.specialInfo=Object.assign(s.specialInfo,e.specialInfo),e.productVos.forEach((e=>{e.name=e.productName})),s.goodsData=e.productVos}))};return u((()=>{let{query:t}=e;n(t.uuid,t.orderState)})),p=((e,t)=>{for(var a in t||(t={}))o.call(t,a)&&r(e,a,t[a]);if(i)for(var a of i(t))l.call(t,a)&&r(e,a,t[a]);return e})({},h(s)),t(p,a({getDetail:n}));var p}};const _=e=>(j("data-v-5cfeeaa7"),e=e(),x(),e),T=_((()=>V("div",{class:"title"},"查看销售订单",-1))),O={key:0,class:"main"},F={class:"main-form"},J=_((()=>V("div",{class:"tit",style:{"margin-bottom":"12px"}},"基础信息",-1))),Y={class:"main-form"},W=_((()=>V("div",{class:"tit",style:{"margin-bottom":"12px"}},"结算信息",-1))),B={class:"main-form"},A=_((()=>V("div",{class:"tit"},"商品信息",-1))),C={key:0,class:"main-form"},z=_((()=>V("div",{class:"tit"},"处方登记",-1))),q={class:"main-form-box"},H=_((()=>V("div",{class:"title"},[V("p",null,"处方来源")],-1))),L={class:"main-form-box"},Q=_((()=>V("div",{class:"title"},[V("p",null,"患者信息")],-1))),$={class:"main-form-box"},G=_((()=>V("div",{class:"title"},[V("p",null,"审核信息")],-1))),K={key:1,class:"main-form"},R=_((()=>V("div",{class:"tit"},"麻黄碱登记",-1))),X={class:"main-form-box"},Z=_((()=>V("div",{class:"title"},[V("p",null,"患者信息")],-1))),ee={key:1,class:"main"},te={class:"main-form"},ae=_((()=>V("div",{class:"tit",style:{"margin-bottom":"12px"}},"基础信息",-1))),ie={class:"main-form"},oe=_((()=>V("div",{class:"tit",style:{"margin-bottom":"12px"}},"结算信息",-1))),le={class:"main-form"},re=_((()=>V("div",{class:"tit"},"商品信息",-1)));var se=E(M,[["render",function(e,t,a,i,o,l){const r=s,m=n,d=k("el-scrollbar"),f=p;return I(),g(f,{class:"detail-view",close:e.close,route:e.go,backTips:!1},{header:v((()=>[T])),default:v((()=>[c(d,null,{default:v((()=>["YB"!==e.$route.query.type?(I(),D("div",O,[V("div",F,[J,c(r,{"form-data":e.formInfo1,"onUpdate:form-data":t[0]||(t[0]=t=>e.formInfo1=t),"submit-form":e.info,"onUpdate:submit-form":t[1]||(t[1]=t=>e.info=t)},null,8,["form-data","submit-form"])]),V("div",Y,[W,c(r,{"form-data":e.formInfo2,"onUpdate:form-data":t[2]||(t[2]=t=>e.formInfo2=t),"submit-form":e.info,"onUpdate:submit-form":t[3]||(t[3]=t=>e.info=t)},null,8,["form-data","submit-form"])]),V("div",B,[A,c(m,{class:"select-table",columns:e.columns,"table-data":e.goodsData,"fixed-head":!1,"option-show":!1},null,8,["columns","table-data"])]),1===e.info.hasEthical?(I(),D("div",C,[z,V("div",q,[H,c(r,{"form-data":e.prescriptionForm.base,"onUpdate:form-data":t[4]||(t[4]=t=>e.prescriptionForm.base=t),"submit-form":e.prescriptionInfo.prescriptionSource,"onUpdate:submit-form":t[5]||(t[5]=t=>e.prescriptionInfo.prescriptionSource=t)},null,8,["form-data","submit-form"])]),V("div",L,[Q,c(r,{"form-data":e.prescriptionForm.patient,"onUpdate:form-data":t[6]||(t[6]=t=>e.prescriptionForm.patient=t),"submit-form":e.prescriptionInfo.patientJson,"onUpdate:submit-form":t[7]||(t[7]=t=>e.prescriptionInfo.patientJson=t)},null,8,["form-data","submit-form"])]),V("div",$,[G,c(r,{"form-data":e.prescriptionForm.remark,"onUpdate:form-data":t[8]||(t[8]=t=>e.prescriptionForm.remark=t),"submit-form":e.prescriptionInfo.approvalJson,"onUpdate:submit-form":t[9]||(t[9]=t=>e.prescriptionInfo.approvalJson=t)},null,8,["form-data","submit-form"])])])):w("",!0),1===e.info.hasSpecial?(I(),D("div",K,[R,V("div",X,[Z,c(r,{"form-data":e.specialForm,"onUpdate:form-data":t[10]||(t[10]=t=>e.specialForm=t),"submit-form":e.specialInfo.patientJson,"onUpdate:submit-form":t[11]||(t[11]=t=>e.specialInfo.patientJson=t)},null,8,["form-data","submit-form"])])])):w("",!0)])):(I(),D("div",ee,[V("div",te,[ae,c(r,{"form-data":e.formInfo1_Yb,"onUpdate:form-data":t[12]||(t[12]=t=>e.formInfo1_Yb=t),"submit-form":e.info,"onUpdate:submit-form":t[13]||(t[13]=t=>e.info=t)},null,8,["form-data","submit-form"])]),V("div",ie,[oe,c(r,{"form-data":e.formInfo2_Yb,"onUpdate:form-data":t[14]||(t[14]=t=>e.formInfo2_Yb=t),"submit-form":e.info,"onUpdate:submit-form":t[15]||(t[15]=t=>e.info=t)},null,8,["form-data","submit-form"])]),V("div",le,[re,c(m,{class:"select-table",columns:e.columns_Yb,"table-data":e.goodsData,"fixed-head":!1,"option-show":!1},null,8,["columns","table-data"])])]))])),_:1})])),_:1},8,["close","route"])}],["__scopeId","data-v-5cfeeaa7"]]);export{se as default};
