var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,i,a)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,s=(e,t)=>{for(var i in t||(t={}))r.call(t,i)&&l(e,i,t[i]);if(a)for(var i of a(t))o.call(t,i)&&l(e,i,t[i]);return e},p=(e,a)=>t(e,i(a));import{_ as d}from"./SubmitButton.99d990fd.js";import{_ as m}from"./EditForm.8c35f1a6.js";import{_ as n}from"./BaseCard.46de0c24.js";import{b as u}from"./vue-router.91336ba9.js";import{o as b,p as c,q as f,h as y}from"./index.05639c88.js";import{c as v}from"./common.6e2a0964.js";import{j as h,e as j,B as g,Y as F,S as x,n as w,D as k,t as L,o as q,c as S,w as C,a6 as O,z as U,a9 as _,aa as D}from"./@vue.23a4bd1a.js";import{_ as z}from"./index.ab904951.js";import"./vuex.c868d4e0.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./public.9c1d8f39.js";import"./element-plus.b44d97a8.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./axios.7b768d2b.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";function A(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!F(e)}const{_:P}=v();var E={name:"AddVipActivityDay",setup(){let e=h({periodSelect1:[{value:1,label:"每周"},{value:2,label:"每月"}],periodSelect2:[],rateList:[]});const t=u();let i=h({isEdit:"",isDisabled:!0,queryUuid:"",editForm1:null,editForm2:null,tabClose:!1,formData:{inline:!0,labelWidth:"120px",span:24,list:[{label:"会员活动日名称",key:"name",type:"INPUT",require:!0,design:{width:"350px"}},{label:"参与等级",key:"participationLevelsArray",type:"SELECT",design:{width:"350px"},require:!0,width:"350px",list:()=>e.rateList,props:{value:"uuid",label:"gradeName"},config:{multiple:!0,onChange:t=>{t.sort(),i.submitForm.participationLevelsArray=t;let a=[],r=[];t.forEach((t=>{a.push(P.find(e.rateList,{uuid:t}).gradeName),r.push(P.find(e.rateList,{uuid:t}).uuid)})),i.submitForm.participationLevels=a.join(","),i.submitForm.participationLevelsUuid=r.join(",")}}},{label:"备注",type:"INPUT",key:"remark",placeholder:"请输入不超过100字",span:10,inputType:"textarea",design:{width:"350px"},config:{showWordLimit:!0,maxlength:100,autosize:{minRows:2}}}]},formData1:{inline:!0,labelWidth:"120px",span:24,list:[{label:"活动周期",key:"period2",type:"TEMP",require:!0,design:{"padding-top":0,width:"500px"},render:()=>{let t,a;return j("div",{style:"display:flex;"},[j(g("el-select"),{style:"width:100px;margin-right:10px",size:"medium",modelValue:i.submitForm.period1,placeholder:"请选择",onChange:e=>{d(e)}},A(t=e.periodSelect1.map((e=>j(g("el-option"),{key:e.value,label:e.label,value:e.value},null))))?t:{default:()=>[t]}),j(g("el-select"),{style:"width:240px",size:"medium",modelValue:i.submitForm.period2Array,placeholder:"请选择",multiple:!0,onChange:e=>{m(e)}},A(a=e.periodSelect2.map((e=>j(g("el-option"),{key:e.value,label:e.label,value:e.value},null))))?a:{default:()=>[a]})])}},{label:"会员商品折扣",key:"discount",type:"INPUT",placeholder:"请输入",require:!0,design:{width:"350px"},tools:{design:{width:"350px"},tempHtml:()=>j("p",{style:"font-size:12px;color:#909399;display:block;"},[x("要求：系数范围不低于5，不大于10")])}},{label:"积分效益系数",key:"pointsBenefitFactor",type:"INPUT",placeholder:"请输入",require:!0,design:{width:"350px"},disabled:()=>i.isDisabled,tools:{design:{width:"350px"},tempHtml:()=>j("div",null,[j("p",{style:"font-size:12px;color:#909399;display:block;"},[x("要求：系数范围不低于1，不大于2")]),j("p",{style:"font-size:12px;color:#909399;display:block;"},[x("举例：一个10积分的商品，若该会员的积分效益系数为1.2，则购买可获得12积分")])])}},{type:"RADIO",key:"status",label:"活动状态",list:()=>[{label:"启用",value:1},{label:"禁用",value:2}],require:!0}]},submitForm:{period1:"",period2:"",participationLevelsArray:[],period2Array:[]}});const l=()=>{t.query.uuid?(i.queryUuid=t.query.uuid,b(t.query.uuid).then((e=>{n(e.period1),i.submitForm.period2Array=e.period2.split(","),i.submitForm.participationLevelsArray=e.participationLevelsUuid.split(","),i.submitForm=Object.assign(i.submitForm,e)}))):(i.queryUuid=void 0,i.submitForm={period1:"",period2:"",status:1})},d=e=>{i.submitForm.period1=e,i.submitForm.period2="",i.submitForm.period2Array=[],n(e)},m=e=>{e.sort(),i.submitForm.period2Array=e,i.submitForm.period2=e.join(",")},n=t=>{if(1===t)e.periodSelect2=[{value:"1",label:"星期一"},{value:"2",label:"星期二"},{value:"3",label:"星期三"},{value:"4",label:"星期四"},{value:"5",label:"星期五"},{value:"6",label:"星期六"},{value:"7",label:"星期日"}];else{e.periodSelect2=[];for(let t=1;t<=31;t++)e.periodSelect2.push({value:t.toString(),label:t.toString()})}};return w((()=>{y().then((t=>{e.rateList=t.memberLevelList}))})),k((()=>{i.isEdit=t.query.uuid,i.queryUuid!==t.query.uuid&&l(),i.submitForm.pointsBenefitFactor=1})),p(s(s({},L(e)),L(i)),{initData:l,handleSubmit:()=>{let{editForm1:e,editForm2:t}=i;t.submitForm.pointsBenefitFactor=1;let l=!0;if(l=e.handleClick(!0),l=t.handleClick(!0),!l)return;let d=i.submitForm,{participation_level_nos:m}=d,n=((e,t)=>{var i={};for(var l in e)r.call(e,l)&&t.indexOf(l)<0&&(i[l]=e[l]);if(null!=e&&a)for(var l of a(e))t.indexOf(l)<0&&o.call(e,l)&&(i[l]=e[l]);return i})(d,["participation_level_nos"]),u=p(s({},n),{participationLevelNos:""});i.isEdit?c(u).then((e=>{i.tabClose=!0})):f(u).then((e=>{i.tabClose=!0}))},handlePeriodChange1:d,handlePeriodChange2:m})}};const T=e=>(_("data-v-08a9ae3f"),e=e(),D(),e),I={style:{"font-size":"16px"}},N=x(" 完成 "),B={class:"top-content"},H=T((()=>O("div",{class:"tit"},"基础信息",-1))),V=T((()=>O("div",{class:"tit"},"活动规则",-1)));var W=z(E,[["render",function(e,t,i,a,r,o){const l=d,s=m,p=n;return q(),S(p,{close:e.tabClose,route:{path:"/vipsales/vip/vip-activity-day"}},{header:C((()=>[O("span",I,U(e.isEdit?"编辑会员活动日":"新增会员活动日"),1),O("div",null,[j(l,{class:"btn",config:{size:"small"},onClick:a.handleSubmit},{default:C((()=>[N])),_:1},8,["onClick"])])])),default:C((()=>[O("div",B,[H,j(s,{"form-data":e.formData,"onUpdate:form-data":t[0]||(t[0]=t=>e.formData=t),"submit-form":e.submitForm,"onUpdate:submit-form":t[1]||(t[1]=t=>e.submitForm=t),style:{"margin-top":"22px"},ref:"editForm1"},null,8,["form-data","submit-form"]),V,j(s,{"form-data":e.formData1,"onUpdate:form-data":t[2]||(t[2]=t=>e.formData1=t),"submit-form":e.submitForm,"onUpdate:submit-form":t[3]||(t[3]=t=>e.submitForm=t),style:{"margin-top":"22px"},ref:"editForm2"},null,8,["form-data","submit-form"])])])),_:1},8,["close"])}],["__scopeId","data-v-08a9ae3f"]]);export{W as default};
