var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a;import{_ as r}from"./element-plus.b44d97a8.js";import{_ as n}from"./index.ab904951.js";import{j as p,h as d,t as c,B as m,o as u,a5 as g,e as f,w as b,x as h,a6 as y,a9 as v,aa as w}from"./@vue.23a4bd1a.js";const j={props:{config:{type:Object,default:()=>({})},accept:{type:String,default:"image/png,image/jpeg,image/jpg"},limit:{type:Number,default:1},files:{type:String,default:()=>""},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},limitSize:{type:Number,default:5120}},setup(e,{emit:n}){const m=p({fileList:[],imgDialogVisible:!1,dialogImageUrl:""}),u=d((()=>e.files?[{url:e.files}]:[])),g=d((()=>""!==e.files)),f=(e,l)=>{let t=document.createElement("canvas"),a=t.getContext("2d"),{width:i}=e,{height:s}=e;return t.width=i,t.height=s,a.fillStyle="#fff",a.fillRect(0,0,t.width,t.height),a.drawImage(e,0,0,i,s),(e=>{let l;l=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);let t=e.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(l.length);for(let i=0;i<l.length;i+=1)a[i]=l.charCodeAt(i);return new Blob([a],{type:t})})(t.toDataURL(l.type||"image/jpeg",.1))};return b=((e,l)=>{for(var t in l||(l={}))i.call(l,t)&&o(e,t,l[t]);if(a)for(var t of a(l))s.call(l,t)&&o(e,t,l[t]);return e})({},c(m)),l(b,t({handleSuccess:(e,l,t)=>{n("handleSuccess",e.data)},handleRemove:()=>{n("handleRemove")},handlePreview:e=>{m.dialogImageUrl=e.url,m.imgDialogVisible=!m.imgDialogVisible},beforeUpload:e=>{let l=e.name.split("."),t=l[l.length-1];return-1===["png","jpeg","jpg"].indexOf(t)?(r.error("只能上传jpg,png格式图片！"),!1):new Promise(((l,t)=>{let a=new Image,i="";a.src=URL.createObjectURL(e),a.onload=()=>{i=f(a,e),l(i)},a.onerror=()=>{t()}}))},getList:u,uploadDisabled:g}));var b}},O={class:"imageUpload"},S=(e=>(v("data-v-5a42e128"),e=e(),w(),e))((()=>y("i",{class:"el-icon-plus"},null,-1))),U=["src"];var D=n(j,[["render",function(e,l,t,a,i,s){const o=m("el-upload"),r=m("el-dialog");return u(),g("div",O,[f(o,h({"list-type":"picture-card",class:{disabled:a.uploadDisabled&&!t.multiple},accept:t.accept,action:"/gateway/chain-store/file/upload",limit:t.limit,limitSize:t.limitSize,"on-success":a.handleSuccess,"on-preview":a.handlePreview,"on-remove":a.handleRemove,"before-upload":a.beforeUpload,fileList:a.getList,disabled:t.disabled,multiple:t.multiple},t.config),{default:b((()=>[S])),_:1},16,["class","accept","limit","limitSize","on-success","on-preview","on-remove","before-upload","fileList","disabled","multiple"]),f(r,{modelValue:e.imgDialogVisible,"onUpdate:modelValue":l[0]||(l[0]=l=>e.imgDialogVisible=l)},{default:b((()=>[y("img",{style:{width:"100%"},src:e.dialogImageUrl,alt:""},null,8,U)])),_:1},8,["modelValue"])])}],["__scopeId","data-v-5a42e128"]]);export{D as _};
