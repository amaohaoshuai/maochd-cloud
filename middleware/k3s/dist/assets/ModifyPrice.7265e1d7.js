var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,l=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&s(e,a,t[a]);if(i)for(var a of i(t))o.call(t,a)&&s(e,a,t[a]);return e},n=(e,i)=>t(e,a(i));import{_ as d}from"./BaseStencil.46c3d678.js";import{e as m,S as c,B as u,J as p,Q as b,G as y,g as f,h,j as g,D as j,t as v,L as k,o as T,a5 as C,w as P,a6 as w}from"./@vue.23a4bd1a.js";import{r as S,s as E,_ as x}from"./index.ab904951.js";import"./element-plus.b44d97a8.js";import{_ as N}from"./BaseName.1aa32b4b.js";import{n as F,o as D}from"./index.6a02aeaf.js";import{u as U}from"./vue-router.91336ba9.js";import{m as A}from"./vuex.c868d4e0.js";import{g as I}from"./businessRule.60794e55.js";import"./BaseForm.bc55ad6b.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./axios.7b768d2b.js";import"./default-passive-events.74004992.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";/* empty css                                                             */const M={0:"待审核",1:"审核通过",2:"审核拒绝"};function O(e,t,a){const i={columns:[{title:"序号",type:"index"},{title:"调价单编号",key:"number"},{title:"门店",key:"business"},{title:"创建人",key:"creator"},{title:"创建时间",key:"createTime"},{title:"审核状态",key:"state",render:e=>[m("div",null,[M[e.state]])]},{title:"操作",width:100,render:(e,t,a,i)=>[m(u("el-button"),{type:"text",onClick:t=>{r(t,"c",e)}},{default:()=>[c("查看")]}),p(m(u("el-button"),{type:"text",onClick:t=>{o(t,"c",e)}},{default:()=>[c("编辑")]}),[[b,1!==e.state]])]}]},r=(e,t,a)=>{S.push({name:"AddAndEditModifyPrice",query:{uuid:a.uuid,type:"see"}})},o=(e,t,a)=>{S.push({name:"AddAndEditModifyPrice",query:{uuid:a.uuid,type:"edit"}})};return{form:{inline:!0,labelWidth:"100px",list:[{type:"LINKAGETIME",keys:["createTime.start","createTime.end"],design:{width:"250px"},key:"createTime",config:{"start-placeholder":"制单开始时间","end-placeholder":"制单结束时间"}},{type:"SELECT",key:"businessUuid",props:{label:"mechanismName",value:"uuid"},config:{multiple:!0,onchange:()=>{}},list:()=>a.value,placeholder:"门店"},{type:"INPUT",key:"creator",placeholder:"请输入创建人"},{type:"SELECT",key:"state",placeholder:"请选择状态",list:()=>[{label:"待审核",value:0},{label:"审核通过",value:1},{label:"审核拒绝",value:2}]},{type:"INPUT",key:"productInfo",placeholder:"请输入商品信息",hidden:!0}]},tableConfig:i}}const L=["name","specification","unit","manufacturer"];function _(e,t,a,i){return{form:{inline:!0,labelWidth:"100px",list:[{type:"LINKAGETIME",keys:["createTime.start","createTime.end"],design:{width:"250px"},key:"createTime",config:{"start-placeholder":"制单开始时间","end-placeholder":"制单结束时间"}},{type:"SELECT",key:"businessUuid",props:{label:"mechanismName",value:"uuid"},config:{multiple:!0},list:()=>a.value,placeholder:"门店"},{type:"INPUT",key:"creator",placeholder:"请输入创建人"},{type:"SELECT",key:"state",hidden:!0,placeholder:"请选择状态",list:()=>[{label:"待审核",value:0},{label:"审核通过",value:1},{label:"审核拒绝",value:2}]},{type:"INPUT",key:"productInfo",placeholder:"请输入商品信息"}]},tableConfig:{columns:[{title:"序号",type:"index"},{title:"调价单编号",key:"number"},{title:"商品编码",key:"code"},{title:"商品名称/规格/单位/生产厂家",key:"",formConfig:{"show-overflow-tooltip":!1,"min-width":210},render:e=>(e.name=e.productName,y(N,{row:e,list:L}))},{title:1==i?"参考零售价":"零售价",key:"oldRetailPrice"},{title:"新零售价",key:"newRetailPrice"},{title:"零售价差额",key:"retailPriceDiff"},{title:1==i?"参考会员价":"会员价",key:"oldMemberPrice"},{title:"新会员价",key:"newMemberPrice"},{title:"门店",key:"business"},{title:"创建人",key:"creator"},{title:"创建时间",key:"createTime"}]}}}var B={name:"ModifyPrice",components:{BaseStencil:d},setup(e,t){const a=f(null),i=A("common",["menus","info","tabs","tabActive"]),{dict:r}=E.state.common,o=U(),s=h(i.info.bind({$store:E})).value.openMultipleStores,d=f([]),m=g({isClear:!1,radio:"汇总",dict:r,otherData:{},tableData:[],loading:!1,deepSearchTable:O(0,0,d),deepSearchTable1:_(0,0,d,s),submitForm:{"page.currentPage":1,"page.pageSize":10,businessUuid:[]}}),c=async()=>{m.loading=!0;try{const e=await E.dispatch("common/mechanism");d.value=e,I(e,m,m.deepSearchTable.form);const t=await F(n(l({},m.submitForm),{businessUuid:m.submitForm.businessUuid.toString()}));m.submitForm.pageNumber=t.current,m.tableData=t.records,m.submitForm.total=t.total,m.loading=!1}catch(e){return m.loading=!1,e}},u=async()=>{m.loading=!0;try{const e=await E.dispatch("common/mechanism");d.value=e,I(e,m,m.deepSearchTable1.form);const t=await D(n(l({},m.submitForm),{businessUuid:m.submitForm.businessUuid.toString()}));m.submitForm.pageNumber=t.current,m.tableData=t.records,m.submitForm.total=t.total,m.loading=!1}catch(e){return m.loading=!1,e}};j((async()=>{"汇总"==m.radio?c():u()}));return n(l({},v(m)),{businessMechanismList:d,getAdjustPriceListData:c,addBatchNumber:()=>{o.push({name:"AddAndEditModifyPrice",query:{type:"add"}})},form:a,handleClick:({item:e,type:t})=>{if("dblclick"===t){let t=e.uuid;o.push({name:"AddAndEditModifyPrice",query:{uuid:"汇总"==m.radio?t:e.adjustPriceUuid,type:"see"}})}},handleChange:e=>{m.radio=e,"汇总"==m.radio?c():u()},getFindDetailData:u})}};const z={class:"modify-price-manage"},q={style:{display:"flex","justify-content":"space-between"}},G=c("新增调价单 ");var R=x(B,[["render",function(e,t,a,i,r,o){const s=u("el-radio-button"),l=u("el-radio-group"),n=u("el-button"),c=d,b=k("loading");return T(),C("div",z,[p(m(c,{"form-data":"汇总"==e.radio?e.deepSearchTable.form:e.deepSearchTable1.form,"submit-form":e.submitForm,"onUpdate:submit-form":t[1]||(t[1]=t=>e.submitForm=t),class:"base-stencil","table-data":e.tableData,columns:"汇总"==e.radio?e.deepSearchTable.tableConfig.columns:e.deepSearchTable1.tableConfig.columns,pagination:e.submitForm,draggable:!1,options:!0,"option-show":!1,select:"汇总"==e.radio?i.getAdjustPriceListData:i.getFindDetailData,ref:"form",spanNmu:3,onOnClick:i.handleClick,isClear:e.isClear},{buttons:P((()=>[w("div",q,[m(l,{modelValue:e.radio,"onUpdate:modelValue":t[0]||(t[0]=t=>e.radio=t),size:"small",onChange:i.handleChange},{default:P((()=>[m(s,{label:"汇总"}),m(s,{label:"明细"})])),_:1},8,["modelValue","onChange"]),m(n,{style:{"margin-bottom":"22px"},type:"primary",onClick:i.addBatchNumber,size:"small"},{default:P((()=>[G])),_:1},8,["onClick"])])])),_:1},8,["form-data","submit-form","table-data","columns","pagination","select","onOnClick","isClear"]),[[b,e.loading]])])}],["__scopeId","data-v-09fbd8e0"]]);export{R as default};
