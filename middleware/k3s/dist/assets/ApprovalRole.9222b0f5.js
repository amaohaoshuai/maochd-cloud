var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o;import{_ as l}from"./SubmitButton.99d990fd.js";import{_ as m}from"./BaseStencil.46c3d678.js";import{_ as d}from"./BaseForm.bc55ad6b.js";import{_ as n}from"./BaseTable.36f55649.js";import{o as p,a as u,b,e as c}from"./index.b67059af.js";import{d as f,_ as g}from"./element-plus.b44d97a8.js";import{d as j}from"./public.9c1d8f39.js";import{g as y}from"./formRule.f80f9ec7.js";import{g as v,j as F,G as h,n as k,t as x,B as w,L as _,o as C,a5 as P,J as V,e as O,w as R,c as z,a6 as A,v as B,S as D}from"./@vue.23a4bd1a.js";import{_ as E}from"./index.ab904951.js";import"./vuex.c868d4e0.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./sortablejs.621e50ab.js";import"./vue-router.91336ba9.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./axios.7b768d2b.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./verification.ecddc814.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";var N={name:"ApprovalRole",components:{BaseTable:n,SubmitButton:l,BaseForm:d},setup(){const e=v(null),l=F({uuid:"",isEdit:!1,dialogFormVisible:!1,formLabelWidth:"110px",submitFormPage:{"page.currentPage":1,"page.pageSize":10},formData:{inline:!1,labelWidth:"110px",config:{size:"medium"},list:[{label:"审批角色名称",type:"INPUT",key:"auditRoleName",placeholder:"请输入",rules:y("Input","审批角色名称"),config:{"show-word-limit":!0,maxlength:20}},{type:"INPUT",placeholder:"请输入",label:"描述",key:"description",config:{"show-word-limit":!0,type:"textarea",maxlength:100,autosize:{minRows:2}}}]},submitForm:{},tableData:[],columns:[{type:"index",title:"序号",formConfig:{width:50}},{title:"角色名称",key:"auditRoleName"},{title:"描述",key:"description"},{title:"最新更新时间",key:"updateTime",width:180},{title:"状态",key:"state",render:e=>1==e.state?"启用":"禁用"},{title:"操作",key:"options",render:e=>{let t=[{type:"text",innerHTML:"编辑",onClick:()=>{l.isEdit=!0,l.dialogFormVisible=!0,l.uuid=e.uuid,l.submitForm={auditRoleName:e.auditRoleName,description:e.description}}},{type:"text",innerHTML:1===e.state?"禁用":"启用",onClick:()=>{let t=1==e.state?"禁用":"启用";j({msg:`确定要${t}该角色吗?`,callback:()=>{p(e.uuid).then((e=>{m()}))}})}}];return h("div",t.map((e=>{if(!e.show)return h(f,e)})))}}]}),m=async()=>{let e=l.submitFormPage,{total:t}=e,a=((e,t)=>{var a={};for(var r in e)i.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&o)for(var r of o(e))t.indexOf(r)<0&&s.call(e,r)&&(a[r]=e[r]);return a})(e,["total"]);u(a).then((e=>{l.submitFormPage.total=e.totalCount,l.tableData=e.list}))};return k((()=>{m()})),d=((e,t)=>{for(var a in t||(t={}))i.call(t,a)&&r(e,a,t[a]);if(o)for(var a of o(t))s.call(t,a)&&r(e,a,t[a]);return e})({},x(l)),t(d,a({getList:m,addForm:e,toAddApprovalRole:()=>{l.dialogFormVisible=!0,l.isEdit=!1},subAdd:async()=>{await e.value.verification()&&b(l.submitForm).then((()=>{l.dialogFormVisible=!1,l.submitForm={},g({type:"success",message:"添加成功"}),m()}))},cancleAdd:()=>{l.dialogFormVisible=!1,l.submitForm={}},subEdit:async()=>{let e={uuid:l.uuid,description:l.submitForm.description,auditRoleName:l.submitForm.auditRoleName};c(e).then((()=>{l.dialogFormVisible=!1,l.submitForm={},g({type:"success",message:"修改成功"}),m()}))},closeDialog:()=>{l.submitForm={}}}));var d}};const T={class:"approval-role"},L=D(" 新增 "),S={class:"dialog-footer"},I=D("取 消"),U=D("确定"),H=D("确定");var M=E(N,[["render",function(e,t,a,o,i,s){const r=l,n=m,p=d,u=w("el-button"),b=w("el-dialog"),c=_("loading");return C(),P("div",T,[V(O(n,{class:"base-stencil","table-data":e.tableData,columns:e.columns,"submit-form":e.submitFormPage,"onUpdate:submit-form":t[0]||(t[0]=t=>e.submitFormPage=t),draggable:!1,pagination:e.submitFormPage,select:o.getList},{buttons:R((()=>[O(r,{class:"addBtn",onClick:o.toAddApprovalRole},{default:R((()=>[L])),_:1},8,["onClick"])])),_:1},8,["table-data","columns","submit-form","pagination","select"]),[[c,e.loading]]),e.dialogFormVisible?(C(),z(b,{key:0,title:e.isEdit?"编辑审批角色管理":"新增审批角色管理",modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[2]||(t[2]=t=>e.dialogFormVisible=t),width:"420px",onClose:o.closeDialog},{footer:R((()=>[A("span",S,[O(u,{size:"small",onClick:o.cancleAdd},{default:R((()=>[I])),_:1},8,["onClick"]),e.isEdit?(C(),z(r,{key:1,size:"small",onClick:o.subEdit},{default:R((()=>[H])),_:1},8,["onClick"])):(C(),z(r,{key:0,size:"small",onClick:o.subAdd},{default:R((()=>[U])),_:1},8,["onClick"]))])])),default:R((()=>[O(p,{"form-data":e.formData,"submit-form":e.submitForm,"onUpdate:submit-form":t[1]||(t[1]=t=>e.submitForm=t),style:{"margin-top":"30px"},ref:"addForm"},null,8,["form-data","submit-form"])])),_:1},8,["title","modelValue","onClose"])):B("",!0)])}],["__scopeId","data-v-0acefa3e"]]);export{M as default};
