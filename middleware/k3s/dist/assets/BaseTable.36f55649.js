var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,r=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&i(e,a,t[a]);if(l)for(var a of l(t))o.call(t,a)&&i(e,a,t[a]);return e},s=(e,l)=>t(e,a(l));import{e as d,Y as c,x as u,B as p,j as g,t as h,o as b,c as m,w as f,a6 as y,z as S,a5 as w,F as C,N as k,S as x,h as T,n as v,q as j,i as z,L as O,v as R,f as D,J as N,a8 as F,Q as _,G as A,a9 as I,aa as B}from"./@vue.23a4bd1a.js";import{_ as E}from"./index.ab904951.js";import{S as P}from"./sortablejs.621e50ab.js";import{u as H}from"./vue-router.91336ba9.js";import{u as M}from"./vuex.c868d4e0.js";import{_ as q}from"./lodash.d7ab6f48.js";import{e as $}from"./element-resize-detector.5b0b5621.js";var L={name:"TableColumns",props:{columns:{type:Array,default:()=>[]},tableRender:{type:Function,default:()=>null},isShow:{type:Function,default:()=>null}},render({columns:e,tableRender:t,isShow:a}){const l=e=>r(r({prop:e.key||e.type,"render-header":e.header,"column-key":e.key,type:e.type,key:e.key||e.type,"header-align":"center",label:e.title,sortable:!!e.sortable&&"custom","sort-orders":["ascending","descending"],width:e.width,fixed:e.fixed,align:e.align||"left",formatter:(a,l,n,o)=>t(e.render,a,l,n,o,e)},a(e.key)),e.formConfig),n=e=>e.map((e=>{if(e.hidden&&e.hidden())return null;if(e.children){let a;return d(p("el-table-column"),u({label:e.title},l(e)),"function"==typeof(t=a=n(e.children))||"[object Object]"===Object.prototype.toString.call(t)&&!c(t)?a:{default:()=>[a]})}return d(p("el-table-column"),u({label:e.title},l(e)),null);var t}));return n(e)}};var W=E({props:{msg:{type:String,default:""},width:{type:Number,default:180}},setup(e){const t=g({showTooltip:!1});return s(r({},h(t)),{showTips:(e,a)=>{let l=document.createElement("span");l.innerText=e,l.className="getTextWidth",document.querySelector("body").appendChild(l);let n=document.querySelector(".getTextWidth").offsetWidth;document.querySelector(".getTextWidth").remove();const o=a-5;t.showTooltip=!(n<=2*o)}})}},[["render",function(e,t,a,l,n,o){const i=p("el-tooltip");return b(),m(i,{placement:"top",modelValue:e.showTooltip,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showTooltip=t),"open-delay":100,content:a.msg,disabled:!e.showTooltip},{default:f((()=>[y("div",{slot:"content",class:"myNote",onMouseenter:t[0]||(t[0]=e=>l.showTips(a.msg,a.width))},S(a.msg),33)])),_:1},8,["modelValue","content","disabled"])}],["__scopeId","data-v-4beadba3"]]);const V={components:{TableBtn:E({props:{btnData:{type:Object,default:()=>({})}},setup(){const e=H(),t=g({count:0});return s(r({},h(t)),{pushBtn:t=>{t.path&&e.push({path:t.path})}})}},[["render",function(e,t,a,l,n,o){const i=p("el-button");return b(),w("div",null,[(b(!0),w(C,null,k(a.btnData,((e,t)=>(b(),m(i,{type:"primary",key:t,onClick:t=>l.pushBtn(e)},{default:f((()=>[x(S(e.name),1)])),_:2},1032,["onClick"])))),128))])}]]),TableColumns:L},props:{btnData:{type:Object,default:()=>({})},tableData:{type:Array,default:()=>[]},tableDataSum:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},pagination:{type:Object,default:()=>({total:1})},pageList:{type:Object,default:()=>({})},draggable:{type:Boolean,default:()=>!1},formConfig:{type:Object,default:()=>({"header-align":"center"})},optionShow:{type:Boolean,default:()=>!0},add:{type:Object,default:()=>({})},maxHeight:Number,fixedHead:{type:Boolean,default:()=>!0},exportExcel:{type:String,default:()=>""},classId:{type:String,default:()=>""},reduceNum:{type:[Number,String],default:0},btnIndex:{type:Number,default:0},loading:{type:Boolean,default:()=>!1},select:Function,sortMethod:Function,tableOptionClick:Function,multipleSelection:Function,singleSelect:Function,allSelect:Function,currentRow:Function,getSummaries:Function,spanMethod:Function,delTable:Function,filterChange:Function,cache:Array,cacheKey:{type:String,default:()=>"uuid"},del:{type:Boolean,default:()=>!1}},emits:["onClick","del","handlcurrentChange"],setup(e,{emit:t}){M();const a=g({tableShow:!0,height:null,elTable:null,tableShow:!1,pageSize:[10,20,50,100],data:[],buttons:[{label:"查看",show:[0,1,2]},{label:"编辑",show:[0,3]},{label:"撤回",show:[1]},{label:"删除",className:"delete",show:[0]}],singeTabel:null}),l=T((()=>"{}"!==JSON.stringify(e.add))),n=H(),o=T((()=>{let{optionShow:t,columns:a}=e;if(t){return!!a.find((e=>"options"===e.key))}return!0})),i=T((()=>["base-table",e.pagination["page.pageSize"]?"base-table-padding":""]));v((()=>{(()=>{const t=$();e.classId?setTimeout((()=>{t.listenTo(document.getElementById(e.classId),(t=>{j((()=>{let l=10;document.getElementsByClassName("btn-box")[0].children.length&&(l+=document.getElementsByClassName("btn-box")[e.btnIndex].offsetHeight),e.pagination["page.pageSize"]&&(l+=60),a.height=e.maxHeight?e.maxHeight:t.offsetHeight-l-e.reduceNum}))}))}),1):a.height=e.maxHeight})(),j((()=>{window.addEventListener("keydown",(t=>{if(46==t.keyCode&&a.singeTabel&&e.delTable){let{index:t}=a.singeTabel;e.delTable(t)}})),a.pageSize=[10,20,50,100,500,1e3],setTimeout((()=>{if(e.draggable){let l=q.cloneDeep(e.tableData);a.data=l;const n=document.querySelector(".el-table__body-wrapper tbody");a.sortable=P.create(n,{onEnd({newIndex:e,oldIndex:a}){t("draggable-change",{newIndex:e,oldIndex:a})}})}}))}))}));z((()=>e.tableData),((t,l)=>{j((()=>{let{cache:l,cacheKey:n}=e;(l||[]).forEach((e=>{let l=q.find(t,{[n]:e[n]});l&&a.elTable&&a.elTable.toggleRowSelection(l)}))}))}));return s(r({},h(a)),{handleClick:(t,a)=>{e.tableOptionClick&&e.tableOptionClick(t,a)},isAdd:l,handleAddClick:(t,a)=>{let{path:l}=a;l?n.push(l):e.tableData.push({index:e.tableData.length+1})},hidden:o,handlSizeChange:t=>{e.pagination["page.pageSize"]=t,e.pagination["page.currentPage"]=1,e.select&&e.select()},handlcurrentChange:a=>{e.pagination["page.currentPage"]=a,e.select&&e.select(),t("handlcurrentChange",a)},handleSelectionChange:t=>{e.multipleSelection&&e.multipleSelection(t)},handleSingleSelection:(t,a)=>{e.singleSelect&&e.singleSelect(t,a)},handleAllSelection:t=>{e.allSelect&&e.allSelect(t)},handleCurrentChange:t=>{a.singeTabel=t,e.currentRow&&e.currentRow(t)},handlRowClick:e=>{t("onClick",{item:e,type:"click"})},handlRowDblclick:e=>{t("onClick",{item:e,type:"dblclick"})},verification:()=>{let{columns:t,tableData:a,tableDataSum:l,pagination:n}=e,o=l.length?l:a,i=t.filter((e=>e.require?e:null)),r=[void 0,null,NaN,""],s=!0,{page:d,size:c}=e.pageList,u=0;return i.forEach((e=>{let{key:t,keyWord:a,judgment:l,rule:i}=e,d=i?[...r,...i]:r,p=t||a,g=-1;o.forEach(((e,t)=>{!d.includes(e[p])||l&&!l(e)?e[`${p}_${n["page.pageSize"]?t%10:t}`]="":(g<0&&(u=Math.floor((t+1)/c)+1,g=u),e[`${p}_${n["page.pageSize"]?t%10:t}`]="error",s=!1)}))})),u&&(e.pageList.page=u),s},handlerSortChange:t=>{e.pagination.orderField=t.prop,e.pagination.orderDirection="ascending"===t.order?"asc":"desc",e.sortMethod?e.sortMethod(t):e.select()},tableRender:(e,t,a,l,n,{isShowTwo:o,width:i,mark:r})=>{let s=[null,void 0,""],d="";if(e)d=e(t,a,l,n);else if(r){d=[...[99999999,100000199,999999,99999,999999999],...s].includes(t[a.property])?"-":t[a.property]}else d=s.includes(t[a.property])?"-":t[a.property];return o?A(W,{msg:d,width:i}):d},isShow:e=>(["options",void 0].indexOf(e),{"show-overflow-tooltip":!1}),allSelect:(e,t)=>{j((()=>{a.elTable.toggleAllSelection(e,t)}))},cancelSelect:()=>{a.elTable.clearSelection()},className:i,filterChange:(t,a,l)=>{e.filterChange(t)},clearFilter:()=>{a.elTable.clearFilter()},picRowClassName:({row:e,rowIndex:t})=>{e.index=t},toggleSelection:e=>{e&&e.forEach((e=>{a.elTable.toggleRowSelection(e)}))}})}},J={class:"btn-box"},K=(e=>(I("data-v-908b1b5a"),e=e(),B(),e))((()=>y("div",{class:"emptyTxt"},"暂无数据",-1))),G={class:"block"};var Q=E(V,[["render",function(e,t,a,l,n,o){const i=p("el-button"),r=L,s=p("el-table-column"),c=p("el-table"),g=p("el-pagination"),h=O("loading");return b(),w("div",{class:F(l.className)},[y("div",J,[l.isAdd?(b(),m(i,{key:0,type:"primary",size:"small",onClick:t[0]||(t[0]=e=>{l.handleAddClick(e,a.add)})},{default:f((()=>[x(S(a.add.name||"新增"),1)])),_:1})):R("",!0),D(e.$slots,"buttons",{},void 0,!0)]),N(d(c,u({data:a.tableData,style:{width:"99.9%",color:"#1b1c1d"},border:"","header-row-class-name":"has-gutter",height:e.height,"max-height":1500,onSelect:l.handleSingleSelection,onSelectAll:l.handleAllSelection,onSelectionChange:l.handleSelectionChange,onCurrentChange:l.handleCurrentChange,ref:"elTable","summary-method":a.getSummaries,"span-method":a.spanMethod,onRowClick:l.handlRowClick,onRowDblclick:l.handlRowDblclick,onSortChange:l.handlerSortChange,"header-cell-style":{background:"#e4e7ed",color:"#1B1C1D",borderColor:"red"},onFilterChange:l.filterChange,"row-class-name":l.picRowClassName},a.formConfig),{empty:f((()=>[K])),default:f((()=>[d(r,{columns:a.columns,tableRender:l.tableRender,isShow:l.isShow},null,8,["columns","tableRender","isShow"]),l.hidden?R("",!0):(b(),m(s,{key:0,label:"操作",width:"130"},{default:f((t=>[(b(!0),w(C,null,k(e.buttons,((e,a)=>(b(),w(C,{key:a},[e.show.includes(t.row.state)?(b(),m(i,{key:0,type:"text",onClick:e=>l.handleClick(t.row,a),class:F(e.className)},{default:f((()=>[x(S(e.label),1)])),_:2},1032,["onClick","class"])):R("",!0)],64)))),128))])),_:1}))])),_:1},16,["data","height","onSelect","onSelectAll","onSelectionChange","onCurrentChange","summary-method","span-method","onRowClick","onRowDblclick","onSortChange","onFilterChange","row-class-name"]),[[h,a.loading]]),D(e.$slots,"selectTable",{},void 0,!0),N(y("div",G,[d(g,{"current-page":a.pagination["page.currentPage"],"page-sizes":e.pageSize,"page-size":a.pagination["page.pageSize"],layout:"total, sizes, prev, pager, next, jumper",total:a.pagination.total,onSizeChange:l.handlSizeChange,onCurrentChange:l.handlcurrentChange},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"])],512),[[_,a.pagination["page.pageSize"]]])],2)}],["__scopeId","data-v-908b1b5a"]]);export{Q as _};
