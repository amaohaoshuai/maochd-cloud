var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,o=(e,t)=>{for(var a in t||(t={}))l.call(t,a)&&r(e,a,t[a]);if(i)for(var a of i(t))s.call(t,a)&&r(e,a,t[a]);return e};import{a as m}from"./BaseForm.bc55ad6b.js";import{_ as n}from"./BaseStencil.46c3d678.js";import{_ as u}from"./BaseName.1aa32b4b.js";import{G as d,e as p,g as c,j as b,D as f,t as g,B as h,L as y,o as v,a5 as x,J as j,w as T,a6 as w,x as k,S as U}from"./@vue.23a4bd1a.js";import{a as C,g as F}from"./RetailReport.1533bc91.js";import{_ as D}from"./index.ab904951.js";import{u as N}from"./vue-router.91336ba9.js";import{f as _}from"./filter.c2c8f0b9.js";import"./element-plus.b44d97a8.js";import{s as P,g as z}from"./businessRule.60794e55.js";import{u as V}from"./vuex.c868d4e0.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";/* empty css                                                             */import"./axios.7b768d2b.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";const E=["name","specification","unit","manufacturer"];function G(e,t,a,i){return{form:{inline:!0,labelWidth:"100px",list:[{type:"INPUT",key:"product",placeholder:"商品编码/品名/助记码/条形码",design:{width:"220px"}},{type:"SELECT",list:()=>a.value,placeholder:"请选择门店",config:{multiple:!0},props:{label:"name",value:"uuid"},key:"businessUuid"},{type:"SELECT",config:{multiple:!0},list:()=>i.value,placeholder:"请选择柜组",props:{label:"name",value:"uuid"},key:"cabinetGroupName"}]},tableConfig:{columns:[{type:"index",title:"序号",width:52,fixed:"left"},{title:"商品编码",key:"productCode",width:180,sortable:!0},{title:"商品名称/规格/单位/生产厂家",key:"name",formConfig:{"min-width":200},render:e=>d(u,{row:e,list:E})},{title:"库存数量",key:"overallPackNum",width:110,align:"right",sortable:!0,render:e=>p("div",null,[0==e.overallPackNum&&0!=e.deleavePackNum?"":0==e.overallPackNum&&0==e.deleavePackNum?"-":e.overallPackNum,e.overallPackNum?e.unit:"",e.deleavePackNum?e.deleavePackNum:"",e.deleavePackNum?e.splitUnit:""])},{title:"出库数量",key:"overNum",width:110,sortable:!0,align:"right"},{title:"零售价",key:"retailPrice",width:110,sortable:!0,align:"right"},{title:"成本进价",key:"overallPackPrice",width:110,sortable:!0,align:"right"},{title:"柜组",key:"cabinetGroupName",width:110,sortable:!0},{title:"门店",key:"business",formConfig:{"min-width":200}},{title:"末次业务时间",key:"createTime",width:160,sortable:!0}]}}}var B={name:"MovingPin",setup(e,r){const m=c(null),n=V(),{dict:u}=n.state.common,{storeUuid:d}=n.state.common.info,p=c([]),h=c([]),y=N(),v=b({isClear:!1,config:{onChange:e=>{}},excelUrl:"",design:{width:"240px"},keys:["beginTime","endTime"],activeName:"1",dict:u,otherData:{},tableData:[],loading:!1,exportBusinessUuid:"",deepSearchTable:G(0,0,p,h),submitForm:{"page.currentPage":1,"page.pageSize":10,startDate:_(new Date),product:"",beginTime:"",endTime:"",businessUuid:[],cabinetGroupUuid:[]}}),x=async()=>{v.loading=!0;try{let e="";e="5"==v.activeName?"":_(v.submitForm.startDate);let t=v.submitForm,{businessUuid:a,cabinetGroupUuid:r,cabinetGroupName:m,startDate:u}=t,d=((e,t)=>{var a={};for(var r in e)l.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&s.call(e,r)&&(a[r]=e[r]);return a})(t,["businessUuid","cabinetGroupUuid","cabinetGroupName","startDate"]),p=o({startDate:e,businessUuid:P(a),type:v.activeName,cabinetGroupUuid:P(m)},d),c=await n.dispatch("common/mechanism"),b="";c.map((e=>{b+=e.uuid+","})),b=","==b.substring(b.length-1)?b.substring(0,b.length-1):b,0==v.submitForm.businessUuid.length?v.exportBusinessUuid=b:v.exportBusinessUuid=a;const f=await C(p);v.submitForm.pageNumber=f.currentPage,v.tableData=f.list,v.tableData.map((e=>{e.name=e.productName,e.drugUuid=e.productUuid})),v.submitForm.total=f.totalElements,v.loading=!1}catch(e){return v.loading=!1,e}};f((()=>{x(),j()}));const j=async()=>{const e=await n.dispatch("common/mechanism");p.value=e;const t=await F();h.value=t,z(e,v,v.deepSearchTable.form)};return T=o({handleClick:(e,t)=>{x()}},g(v)),t(T,a({getMovableListData:x,addBatchNumber:()=>{y.push({name:"BatchNumberAdd"})},exportExcel:e=>{v.excelUrl=5!=e?"/gateway/chain-store/order/report/query/movable/export?storeUuid="+d+"&product="+v.submitForm.product+"&businessUuid="+v.exportBusinessUuid+"&type="+e+"&startDate="+_(v.submitForm.startDate)+"&cabinetGroupUuid="+v.submitForm.cabinetGroupName+"&beginTime="+v.submitForm.beginTime+"&endTime="+v.submitForm.endTime+"&exportType=2":"/gateway/chain-store/order/report/query/movable/export?storeUuid="+d+"&product="+v.submitForm.product+"&businessUuid="+v.exportBusinessUuid+"&startDate="+_(v.submitForm.startDate)+"&cabinetGroupUuid="+v.submitForm.cabinetGroupName+"&beginTime="+v.submitForm.beginTime+"&endTime="+v.submitForm.endTime+"&exportType=2"},businessMechanismList:p,cabinetGroupList:h,form:m,selectTime:e=>{x()},startTimeChange:e=>{v.submitForm.beginTime=e,x()},endTimeChange:e=>{v.submitForm.endTime=e,x()}}));var T}};const S={class:"business-manage"},O={style:{display:"flex","justify-content":"space-between"}},L=["href"],M=U(" 导出 "),I={style:{display:"flex","justify-content":"space-between"}},R=["href"],q=U(" 导出 "),A={style:{display:"flex","justify-content":"space-between"}},H=["href"],J=U(" 导出 "),W={style:{display:"flex","justify-content":"space-between"}},K=["href"],Q=U(" 导出 "),X={style:{display:"flex","justify-content":"space-between"}},Y=["href"],Z=U(" 导出 ");var $=D(B,[["render",function(e,t,a,i,l,s){const r=h("el-date-picker"),o=h("el-form-item"),u=h("el-form"),d=h("el-button"),c=h("el-tab-pane"),b=m,f=h("el-tabs"),g=n,U=y("loading");return v(),x("div",S,[j(p(g,{"form-data":e.deepSearchTable.form,"submit-form":e.submitForm,"onUpdate:submit-form":t[10]||(t[10]=t=>e.submitForm=t),class:"base-stencil","table-data":e.tableData,columns:e.deepSearchTable.tableConfig.columns,pagination:e.submitForm,draggable:!1,options:!0,"option-show":!1,select:i.getMovableListData,ref:"form",otherData:e.deepSearchTable.tableConfig.listData,isClear:e.isClear},{buttons:T((()=>[p(f,{modelValue:e.activeName,"onUpdate:modelValue":t[9]||(t[9]=t=>e.activeName=t),onTabClick:i.handleClick},{default:T((()=>[p(c,{label:"日",name:"1"},{default:T((()=>[w("div",O,[p(u,{size:"small"},{default:T((()=>[p(o,{label:"日期"},{default:T((()=>[p(r,{modelValue:e.submitForm.startDate,"onUpdate:modelValue":t[0]||(t[0]=t=>e.submitForm.startDate=t),type:"date",onChange:i.selectTime,placeholder:"选择日期"},null,8,["modelValue","onChange"])])),_:1})])),_:1}),w("a",{href:e.excelUrl,download:"动销查询列表.xlsx"},[p(d,{class:"moving-btn",size:"small",type:"primary",onClick:t[1]||(t[1]=e=>i.exportExcel(1))},{default:T((()=>[M])),_:1})],8,L)])])),_:1}),p(c,{label:"周",name:"2"},{default:T((()=>[w("div",I,[p(u,{size:"small"},{default:T((()=>[p(o,{label:"日期"},{default:T((()=>[p(r,{modelValue:e.submitForm.startDate,"onUpdate:modelValue":t[2]||(t[2]=t=>e.submitForm.startDate=t),type:"week",onChange:i.selectTime,format:"gggg 第 ww 周",placeholder:"选择周"},null,8,["modelValue","onChange"])])),_:1})])),_:1}),w("a",{href:e.excelUrl,download:"动销查询列表.xlsx"},[p(d,{class:"moving-btn",size:"small",type:"primary",onClick:t[3]||(t[3]=e=>i.exportExcel(2))},{default:T((()=>[q])),_:1})],8,R)])])),_:1}),p(c,{label:"月",name:"3"},{default:T((()=>[w("div",A,[p(u,{size:"small"},{default:T((()=>[p(o,{label:"日期"},{default:T((()=>[p(r,{modelValue:e.submitForm.startDate,"onUpdate:modelValue":t[4]||(t[4]=t=>e.submitForm.startDate=t),type:"month",onChange:i.selectTime,placeholder:"选择月"},null,8,["modelValue","onChange"])])),_:1})])),_:1}),w("a",{href:e.excelUrl,download:"动销查询列表.xlsx"},[p(d,{size:"small",class:"moving-btn",type:"primary",onClick:t[5]||(t[5]=e=>i.exportExcel(3))},{default:T((()=>[J])),_:1})],8,H)])])),_:1}),p(c,{label:"年",name:"4"},{default:T((()=>[w("div",W,[p(u,{size:"small"},{default:T((()=>[p(o,{label:"日期"},{default:T((()=>[p(r,{modelValue:e.submitForm.startDate,"onUpdate:modelValue":t[6]||(t[6]=t=>e.submitForm.startDate=t),type:"year",onChange:i.selectTime,placeholder:"选择年"},null,8,["modelValue","onChange"])])),_:1})])),_:1}),w("a",{href:e.excelUrl,download:"动销查询列表.xlsx"},[p(d,{size:"small",class:"moving-btn",type:"primary",onClick:t[7]||(t[7]=e=>i.exportExcel(4))},{default:T((()=>[Q])),_:1})],8,K)])])),_:1}),p(c,{label:"时间区间",name:"5"},{default:T((()=>[w("div",X,[p(u,{size:"small"},{default:T((()=>[p(o,{label:"时间区间"},{default:T((()=>[p(b,k({ref:"linkageTime",keys:e.keys,"submit-form":e.submitForm,design:e.design},e.config,{onStartTimeChange:i.startTimeChange,onEndTimeChange:i.endTimeChange}),null,16,["keys","submit-form","design","onStartTimeChange","onEndTimeChange"])])),_:1})])),_:1}),w("a",{href:e.excelUrl,download:"动销查询列表.xlsx"},[p(d,{class:"moving-btn",size:"small",type:"primary",onClick:t[8]||(t[8]=e=>i.exportExcel(5))},{default:T((()=>[Z])),_:1})],8,Y)])])),_:1})])),_:1},8,["modelValue","onTabClick"])])),_:1},8,["form-data","submit-form","table-data","columns","pagination","select","otherData","isClear"]),[[U,e.loading]])])}],["__scopeId","data-v-363e6287"]]);export{$ as default};
