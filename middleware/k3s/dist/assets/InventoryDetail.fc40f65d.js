var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,l=(e,t)=>{for(var o in t||(t={}))s.call(t,o)&&r(e,o,t[o]);if(a)for(var o of a(t))i.call(t,o)&&r(e,o,t[o]);return e},m=(e,a)=>t(e,o(a));import{_ as n}from"./BaseForm.bc55ad6b.js";import{_ as u}from"./BaseTable.36f55649.js";import{_ as c}from"./BaseCard.46de0c24.js";import{u as p}from"./vuex.c868d4e0.js";import{b,f as d}from"./index.817e3859.js";import{u as f,b as v}from"./vue-router.91336ba9.js";import{e as y}from"./element-resize-detector.5b0b5621.js";import{c as j}from"./data.c063697f.js";import{g}from"./RetailReport.1533bc91.js";import{_ as C}from"./lodash.d7ab6f48.js";import{_ as L}from"./index.ab904951.js";import{j as h,n as F,D as w,t as x,B as D,o as N,c as U,w as _,a6 as T,e as $,z as O,q as S,a9 as k,aa as B,S as P}from"./@vue.23a4bd1a.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./sortablejs.621e50ab.js";import"./public.9c1d8f39.js";import"./element-plus.b44d97a8.js";import"./resize-observer-polyfill.d4249adb.js";import"./dayjs.bad04745.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./axios.7b768d2b.js";import"./batch-processor.94093b2a.js";import"./BaseName.1aa32b4b.js";/* empty css                                                             */import"./BaseNotice.93ee8e4e.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./default-passive-events.74004992.js";const E={components:{BaseTable:u},name:"InventoryDetail",setup(){f();const e=p(),t=v(),o=h({active:"0"}),a=h({getCabinetgroupList:[],fileName:"未盘商品",close:!1,href:"/gateway/chain-store/inventory/exportExcel",go:{path:"/storage/inventory"},formData:{labelWidth:"70px",inline:!0,list:[{label:"门店",type:"INPUT",key:"business",disabled:()=>!0},{label:"商品名称",type:"INPUT",key:"productName",placeholder:"请输入商品名称/助记码/编码"},{label:"差异状态",type:"SELECT",disabled:()=>"0"===o.active,key:"differences",list:()=>[{value:"0",label:"无差异"},{value:"1",label:"盘损"},{value:"2",label:"盘溢"}]},{type:"SELECT",label:"柜组",key:"cabinetGroupUuid",list:()=>a.getCabinetgroupList,props:{label:"name",value:"uuid"}}]},submitForm:{"page.currentPage":1,"page.pageSize":10},compList:[],compListDetail:[],notCompList:[],columns:j("","",!0),compListCount:0,compListDetailCount:0,notCompListCount:0,inventoryNo:""}),s=async()=>{let{list:e,totalCount:t}=await b(m(l({},a.submitForm),{state:Number(o.active)}));var s,i;a.compList=(s=e,i=o.cache,s.forEach(((e,t)=>{let{uuid:o}=e,a=C.find(i,{uuid:o});a&&(s[t]=a)})),s),a.submitForm.total=t},i=async()=>{let{compListCount:e,compListDetailCount:t,notCompListCount:o}=await d(a.submitForm);a.compListCount=e,a.compListDetailCount=t,a.notCompListCount=o,a.getCabinetgroupList=await g()};return F((()=>{(()=>{const e=y();setTimeout((()=>{e.listenTo(document.getElementById("tab"),(e=>{S((()=>{a.height=e.offsetHeight-390}))}))}),200)})()})),w((()=>{let e=JSON.parse(t.query.row);a.inventoryNo=e.inventoryNo,e.uuid!==a.submitForm.uuid&&(a.submitForm=m(l(l({},a.submitForm),e),{inventoryUuid:t.query.uuid}),s(),i())})),m(l(l({},x(o)),x(a)),{handleSubmit:()=>{},getDetail:s,handleDownLoad:t=>{a.fileName=`${["未盘商品","已盘商品","已盘商品明细"][o.active]}.xlsx`;let s=(a.submitForm.differences?`&differences=${a.submitForm.differences}`:"")+(a.submitForm.productName?`&productName=${a.submitForm.productName}`:"")+(a.submitForm.cabinetGroupUuid?` &cabinetGroupUuid=${a.submitForm.cabinetGroupUuid}`:"")+(a.submitForm.businessUuid?`  &businessUuid=${a.submitForm.businessUuid}`:"");a.href=`/gateway/chain-store/inventoryrel/info/export?state=${o.active}&storeUuid=${e.state.common.info.storeUuid}&inventoryUuid=${a.submitForm.uuid}${s}`},handleClick:e=>{a.submitForm["page.currentPage"]=1,a.submitForm["page.pageSize"]=10,s()},query:()=>{s(),i()}})}},z=(e=>(k("data-v-0247f063"),e=e(),B(),e))((()=>T("div",{class:"title"},"查看盘点任务",-1))),I={class:"top-content"},q={class:"result"},A={class:"title"},G={class:"box"},R={class:"text"},V=P(" 实盘总成本金额合计： "),H={style:{color:"#1890ff"}},J=P(" 元 "),W={class:"text"},K=P(" 盈亏总成本金额合计： "),M={style:{color:"#f56c6c"}},Q=P(" 元 "),X={class:"text"},Y=P(" 实盘零售金额合计： "),Z={style:{color:"#1890ff"}},ee=P(" 元 "),te={class:"text"},oe=P(" 盈亏零售金额合计： "),ae={style:{color:"#f56c6c"}},se=P(" 元 "),ie={class:"tabs-box"},re={class:"options"},le=["href","download"];var me=L(E,[["render",function(e,t,o,a,s,i){const r=n,l=u,m=D("el-tab-pane"),p=D("el-tabs"),b=c;return N(),U(b,{close:e.close,route:e.go,class:"inventory base-stencil","t-id":"tab",backTips:!1},{header:_((()=>[z])),top:_((()=>[T("div",I,[$(r,{"form-data":e.formData,"submit-form":e.submitForm,"onUpdate:submit-form":t[0]||(t[0]=t=>e.submitForm=t),options:!0,select:a.query},null,8,["form-data","submit-form","select"]),T("div",q,[T("div",A,O(e.inventoryNo)+"盘点结果",1),T("div",G,[T("div",R,[V,T("span",H,O(e.submitForm.firmOfferCostAmount),1),J]),T("div",W,[K,T("span",M,O(e.submitForm.profitLossCostAmount),1),Q]),T("div",X,[Y,T("span",Z,O(e.submitForm.firmRetailAmount),1),ee]),T("div",te,[oe,T("span",ae,O(e.submitForm.profitLossRetailAmount),1),se])])])])])),default:_((()=>[T("div",ie,[T("div",re,[T("button",{onClick:t[1]||(t[1]=(...e)=>a.handleDownLoad&&a.handleDownLoad(...e))},[T("a",{href:e.href,download:e.fileName},"导出",8,le)])]),$(p,{modelValue:e.active,"onUpdate:modelValue":t[2]||(t[2]=t=>e.active=t),onTabClick:a.handleClick},{default:_((()=>[$(m,{label:`未盘商品批号(${e.notCompListCount})`,name:"0"},{default:_((()=>[$(l,{columns:e.columns.notCompList,"table-data":e.compList,optionShow:!1,select:a.getDetail,pagination:e.submitForm,"class-id":"tab","reduce-num":74},null,8,["columns","table-data","select","pagination"])])),_:1},8,["label"]),$(m,{label:`已盘商品批号(${e.compListCount})`,name:"1"},{default:_((()=>[$(l,{columns:e.columns.compList,"table-data":e.compList,optionShow:!1,select:a.getDetail,pagination:e.submitForm,"class-id":"tab","reduce-num":74},null,8,["columns","table-data","select","pagination"])])),_:1},8,["label"]),$(m,{label:`已盘商品明细(${e.compListDetailCount})`,name:"2"},{default:_((()=>[$(l,{columns:e.columns.compListDetail,"table-data":e.compList,optionShow:!1,select:a.getDetail,pagination:e.submitForm,"class-id":"tab","reduce-num":74},null,8,["columns","table-data","select","pagination"])])),_:1},8,["label"])])),_:1},8,["modelValue","onTabClick"])])])),_:1},8,["close","route"])}],["__scopeId","data-v-0247f063"]]);export{me as default};
