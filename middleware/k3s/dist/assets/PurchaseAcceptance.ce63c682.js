var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,o=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&s(e,a,t[a]);if(i)for(var a of i(t))l.call(t,a)&&s(e,a,t[a]);return e};import{_ as n}from"./BaseStencil.46c3d678.js";import{d as c}from"./element-plus.b44d97a8.js";import{B as p}from"./BaseSelect.4937342b.js";import{g as m,j as u,G as d,n as h,D as y,t as b,B as f,o as g,a5 as k,J as w,e as T,w as v,a6 as j,z as D,Q as C,q as N,S as x}from"./@vue.23a4bd1a.js";import{_ as A,r as P}from"./index.ab904951.js";import{g as L,a as E,b as F,c as O,s as S,d as U}from"./PurchaseAcceptance.9cfc0e35.js";import{h as _}from"./moment.08a7f518.js";import{d as B}from"./public.9c1d8f39.js";import{s as M,g as q}from"./businessRule.60794e55.js";import{u as Y}from"./vuex.c868d4e0.js";import"./lodash.d7ab6f48.js";import{g as z,f as H}from"./filter.c2c8f0b9.js";import{_ as I}from"./BaseName.1aa32b4b.js";import"./BaseForm.bc55ad6b.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./vue-router.91336ba9.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./resize-observer-polyfill.d4249adb.js";import"./dayjs.bad04745.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./axios.7b768d2b.js";import"./default-passive-events.74004992.js";/* empty css                                                             */const R={name:"PurchaseAcceptance",components:{BaseStencil:n,BaseSelect:p},setup(){const e=new Date;let s=z(e,30,!0);const n=Y(),p=m([]),f=u({acceptTotal:{},acceptDetailTotal:{},isClear:!1,baseNameList:["name","specification","unit","manufacturer"],pageType:"1",tloading:!1,supplierList:[],btnData:{isAdd:!0,path:"/purchase/add-purchase-acceptance",name:"新增验收单"},formData:{inline:!0,labelWidth:"82px",list:[{type:"LINKAGETIME",design:{width:"240px"},keys:["createTimeStart","createTimeEnd"],key:"createTime",config:{"start-placeholder":"制单开始时间","end-placeholder":"制单结束时间"}},{type:"SELECT",key:"supplierName",width:180,placeholder:"供应商名称",list:()=>f.supplierList},{label:"",type:"SELECT",placeholder:"请选择门店",config:{multiple:!0},key:"businessUuid",props:{label:"name",value:"uuid"},list:()=>p.value},{type:"INPUT",key:"checkNo",placeholder:"验收单编号",width:180},{type:"INPUT",key:"receiveNo",placeholder:"收货单编号",width:180},{type:"INPUT",key:"invincible",placeholder:"商品信息",hidden:!0}]},tableData:[],columns:[],columns1:[{title:"序号",type:"index",width:52},{key:"checkNo",title:"验收单编号",width:135,render:e=>d(c,{type:"text",innerHTML:e.checkNo,onClick:()=>{P.push({name:"AddPurchaseAcceptance",query:{uuid:e.uuid,isDetail:!0}})}})},{title:"随货同行单",key:"peer",width:80},{title:"开票日期",key:"invoiceTime",width:110},{key:"supplierName",title:"供应商名称",formConfig:{"min-width":180}},{key:"categories",title:"商品种类",align:"right",width:100},{key:"checkNum",title:"验收数量",align:"right",width:120},{key:"totalAmountTax",title:"含税金额合计",align:"right",width:120},{key:"applicant",title:"验收员",formConfig:{"min-width":76}},{key:"createTime",title:"制单时间",width:110},{title:"门店",key:"business",formConfig:{"min-width":150}},{key:"receiveNo",title:"收货单编号",width:135,render:e=>d(c,{type:"text",innerHTML:e.receiveNo,onClick:()=>{P.push({name:"AddPurchaseDispatch",query:{uuid:e.receiveUuid,returnPath:"/purchase/purchase-acceptance"}})}})},{key:"options",title:"操作",width:150,render:e=>{let t=[{type:"text",innerHTML:"查看",onClick:()=>{k(e)}},{type:"text",innerHTML:"删除",show:0!=e.status,style:{color:"#f56c6c"},onClick:()=>{B({msg:"确定要删除吗?",callback:()=>{T(e)}})}}];return d("div",t.map((e=>{if(!e.show)return d(c,e)})))}}],columns2:[{title:"序号",type:"index",width:52},{key:"checkNo",title:"验收单编号",width:135,render:e=>d(c,{type:"text",innerHTML:e.checkNo,onClick:()=>{P.push({name:"AddPurchaseAcceptance",query:{uuid:e.checkUuid,isDetail:!0}})}})},{title:"随货同行单",key:"peer",width:80},{title:"开票日期",key:"invoiceTime",width:110},{key:"productCode",title:"商品编码",formConfig:{"min-width":120}},{title:"商品名称/规格/单位/生产厂家",key:"name",width:256,render:e=>d(I,{row:e,list:f.baseNameList}),formConfig:{"show-overflow-tooltip":!1}},{key:"batchNumber",title:"批号",formConfig:{"min-width":120}},{key:"productionDate",title:"生产日期",width:100},{key:"expireDate",title:"有效期至",width:100},{key:"checkNum",title:"验收数量",align:"right"},{key:"checkResult",title:"验收结果"},{key:"taxPaid",title:"含税进价",align:"right"},{key:"taxAmount",title:"含税金额",align:"right"},{key:"price",title:"进价",align:"right"},{key:"amount",title:"金额",align:"right"},{key:"retailPrice",title:"零售价",align:"right"},{key:"retailAmount",title:"零售金额",align:"right"},{key:"inputTaxRate",title:"税率",width:100},{key:"tax",title:"税额",align:"right"},{key:"receiveNum",title:"收货数量",align:"right"},{key:"returnNum",title:"拒收数量",align:"right"},{key:"refuseReason",title:"拒收原因",formConfig:{"min-width":120}},{key:"medicineBeverage",title:"中药饮片产地",width:120},{key:"approvalNumber",title:"批准文号",formConfig:{"min-width":176}},{key:"holderPermit",title:"上市许可持有人",formConfig:{"min-width":150}},{key:"planDate",title:"制单时间",width:110},{title:"门店",key:"business",formConfig:{"min-width":150}},{key:"receiveNo",title:"收货单编号",width:135,render:e=>d(c,{type:"text",innerHTML:e.receiveNo,onClick:()=>{P.push({name:"AddPurchaseDispatch",query:{uuid:e.receiveUuid,returnPath:"/purchase/purchase-acceptance"}})}})}],submitForm:{"page.currentPage":1,"page.pageSize":10,createTimeStart:s[0],createTimeEnd:H(new Date),businessUuid:[]}}),g=async()=>{let e=f.submitForm,{total:t,businessUuid:a}=e,s=((e,t)=>{var a={};for(var s in e)r.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&i)for(var s of i(e))t.indexOf(s)<0&&l.call(e,s)&&(a[s]=e[s]);return a})(e,["total","businessUuid"]);a=M(a);let n=o({businessUuid:a},s);f.tloading=!0,"1"==f.pageType?(f.acceptTotal=await L(n),f.columns=f.columns1,E(n).then((e=>{f.tableData=e.list,f.submitForm.total=e.totalElements,f.tloading=!1}))):(f.acceptDetailTotal=await F(n),f.columns=f.columns2,O(n).then((e=>{f.tableData=e.list,f.submitForm.total=e.totalElements,f.tloading=!1})))},k=e=>{P.push({name:"AddPurchaseAcceptance",query:{uuid:e.uuid,isDetail:!0}})},w=()=>{S().then((e=>{let t=e.map((function(e,t){return{label:e.supplierName,value:e.supplierName}}));f.supplierList=t}))},T=e=>{U(e.uuid).then((e=>{g()}))},v=async()=>{try{p.value=await n.dispatch("common/mechanism"),q(p.value,f,f.formData)}catch(e){return e}};return h((()=>{w()})),y((()=>{N((()=>{f.submitForm.createTimeStart=s[0],f.submitForm.createTimeEnd=H(new Date)})),g(),v()})),j=o({},b(f)),t(j,a({getCheckAcceptList:g,toDetail:k,handleClick:({item:e,type:t})=>{if("dblclick"===t){let t=e.uuid;P.push({name:"AddPurchaseAcceptance",query:{uuid:t,isDetail:!0}})}},getsupplierList:w,toEdit:e=>{P.push({name:"AddPurchaseAcceptance",query:{uuid:e.uuid,isEdit:!0}})},getFindListData:v,baseData:()=>{f.submitForm.createTimeStart=_().subtract(30,"days").format("YYYY-MM-DD"),f.submitForm.createTimeEnd=_().format("YYYY-MM-DD")},typeChange:e=>{let t=f.formData.list;1==e&&(t[t.length-1].hidden=!0),2==e&&(t[t.length-1].hidden=!1),g()}}));var j}},V={class:"purchaseAcceptance"},G=x("汇总"),J=x("明细"),K={class:"total_style"},Q={class:"money"};var W=A(R,[["render",function(e,t,a,i,r,l){const s=f("el-radio-button"),o=f("el-radio-group"),c=n;return g(),k("div",V,[w(T(c,{onOnClick:i.handleClick,loading:e.tloading,class:"base-stencil",add:e.btnData,"form-data":e.formData,options:!0,"submit-form":e.submitForm,"onUpdate:submit-form":t[2]||(t[2]=t=>e.submitForm=t),columns:e.columns,"table-data":e.tableData,pagination:e.submitForm,"option-show":!1,select:i.getCheckAcceptList,isClear:e.isClear},{buttons:v((()=>[T(o,{modelValue:e.pageType,"onUpdate:modelValue":t[0]||(t[0]=t=>e.pageType=t),size:"small",style:{float:"left","margin-right":"10px"},onChange:t[1]||(t[1]=t=>i.typeChange(e.pageType))},{default:v((()=>[T(s,{label:"1"},{default:v((()=>[G])),_:1}),T(s,{label:"2"},{default:v((()=>[J])),_:1})])),_:1},8,["modelValue"]),j("div",K,[j("div",Q,[j("span",null,"验收数量："+D("1"===e.pageType?e.acceptTotal.checkNum:e.acceptDetailTotal.checkNum),1),j("span",null,"含税金额："+D("1"===e.pageType?e.acceptTotal.totalAmountTax:e.acceptDetailTotal.totalAmountTax),1),w(j("span",null,"金额："+D(e.acceptDetailTotal.amount),513),[[C,"2"===e.pageType]]),w(j("span",null,"零售金额："+D(e.acceptDetailTotal.retailAmount),513),[[C,"2"===e.pageType]]),w(j("span",null,"税额："+D(e.acceptDetailTotal.tax),513),[[C,"2"===e.pageType]])])])])),_:1},8,["onOnClick","loading","add","form-data","submit-form","columns","table-data","pagination","select","isClear"]),[[C,!0]])])}],["__scopeId","data-v-d00862ac"]]);export{W as default};
