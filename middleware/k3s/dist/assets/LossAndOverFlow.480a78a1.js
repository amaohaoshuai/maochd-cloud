var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,o,s)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,l=(e,t)=>{for(var o in t||(t={}))r.call(t,o)&&i(e,o,t[o]);if(s)for(var o of s(t))a.call(t,o)&&i(e,o,t[o]);return e};import{_ as n}from"./BaseStencil.46c3d678.js";import{d}from"./element-plus.b44d97a8.js";import{B as m}from"./BaseSelect.4937342b.js";import{_ as p,r as u}from"./index.ab904951.js";import{g as c}from"./index.d94b3f7b.js";import{u as f}from"./vuex.c868d4e0.js";import{g as b,s as v}from"./businessRule.60794e55.js";import{j as w,G as h,n as j,D as y,t as g,o as L,a5 as O,e as k}from"./@vue.23a4bd1a.js";import"./BaseForm.bc55ad6b.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./vue-router.91336ba9.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./axios.7b768d2b.js";import"./default-passive-events.74004992.js";const C={class:"purchaseAcceptance"};var S=p({name:"LossAndOverFlow",components:{BaseStencil:n,BaseSelect:m},setup(){let e=f();const i=w({isClear:!1,checkStatusList:[],createrList:[],storeList:[],btnData:{isAdd:!0,path:"/storage/loss-and-overflow-add?type=add",name:"新增损溢单"},formData:{inline:!0,labelWidth:"82px",list:[{type:"INPUT",key:"lossOverflowNo",placeholder:"损溢单编号"},{type:"SELECT",key:"businessUuid",placeholder:"门店",props:{label:"name",value:"uuid"},list:()=>i.storeList,config:{multiple:!0}},{type:"SELECT",key:"auditStatus",placeholder:"审核状态",list:()=>i.checkStatusList},{type:"LINKAGETIME",design:{width:"260px"},keys:["startPlanDate","endPlanDate"],key:"createTime",config:{"start-placeholder":"制单开始时间","end-placeholder":"制单结束时间"}}]},tableData:[],columns:[{title:"序号",type:"index",formConfig:{width:50}},{key:"createTime",title:"制单时间",formConfig:{"show-overflow-tooltip":!1,"min-width":120}},{key:"lossOverflowNo",title:"损溢单编号",formConfig:{"show-overflow-tooltip":!1,"min-width":150}},{key:"totalLossOverflowCost",title:"损溢成本金额",align:"right",formConfig:{"show-overflow-tooltip":!1,"min-width":120}},{key:"business",title:"门店",formConfig:{"show-overflow-tooltip":!1,"min-width":100}},{key:"creator",title:"创建人",formConfig:{"show-overflow-tooltip":!1,"min-width":120}},{key:"auditStatus",title:"审核状态",formConfig:{"show-overflow-tooltip":!1,"min-width":100},render:e=>{let t=e.auditStatus;return 1==t?t="审核中":2==t?t="审核通过":3==t&&(t="审核拒绝"),t}},{key:"options",title:"操作",fixed:"right",width:100,render:e=>{let t=[{type:"text",innerHTML:"查看",onClick:()=>{p(e)}},{type:"text",innerHTML:"编辑",show:3!=e.auditStatus,onClick:()=>{L(e)}}];return h("div",t.map((e=>{if(!e.show)return h(d,e)})))}}],submitForm:{orderField:"createTime",orderDirection:"desc","page.currentPage":1,"page.pageSize":10,businessUuid:[]}}),n=async()=>{i.storeList=await e.dispatch("common/mechanism"),b(i.storeList,i,i.formData),i.checkStatusList=[{label:"审核中",value:1},{label:"审核通过",value:2},{label:"审核拒绝",value:3}]},m=()=>{let e=i.submitForm,{total:t,businessUuid:o}=e,n=((e,t)=>{var o={};for(var i in e)r.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&s)for(var i of s(e))t.indexOf(i)<0&&a.call(e,i)&&(o[i]=e[i]);return o})(e,["total","businessUuid"]);o=v(o);let d=l({businessUuid:o},n);c(d).then((e=>{e.list.forEach((e=>{e.totalLossOverflowCost=parseFloat(e.totalLossOverflowCost).toFixed(2)})),i.tableData=e.list,i.submitForm.total=e.totalElements}))},p=e=>{u.push({name:"LossAndOverFlowAdd",query:{uuid:e.lossOverflowNo,type:"see",isSee:1}})},L=e=>{u.push({name:"LossAndOverFlowAdd",query:{uuid:e.uuid,type:"edit"}})};return j((()=>{n()})),y((()=>{m()})),O=l({},g(i)),t(O,o({getStoreList:n,getLossoverfloworderList:m,LossAndOverFlowdbl:({item:e,type:t})=>{"dblclick"===t&&u.push({name:"LossAndOverFlowAdd",query:{uuid:e.lossOverflowNo,type:"see",isSee:1}})}}));var O}},[["render",function(e,t,o,s,r,a){const i=n;return L(),O("div",C,[k(i,{class:"base-stencil",add:e.btnData,"form-data":e.formData,options:!0,"submit-form":e.submitForm,"onUpdate:submit-form":t[0]||(t[0]=t=>e.submitForm=t),columns:e.columns,"table-data":e.tableData,pagination:e.submitForm,select:s.getLossoverfloworderList,onOnClick:s.LossAndOverFlowdbl,isClear:e.isClear},null,8,["add","form-data","submit-form","columns","table-data","pagination","select","onOnClick","isClear"])])}],["__scopeId","data-v-1b3b1e29"]]);export{S as default};
