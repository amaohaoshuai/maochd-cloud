var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,i,a)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,s=(e,t)=>{for(var i in t||(t={}))r.call(t,i)&&o(e,i,t[i]);if(a)for(var i of a(t))l.call(t,i)&&o(e,i,t[i]);return e},d=(e,a)=>t(e,i(a));import{_ as n}from"./BaseStencil.46c3d678.js";import{G as u,e as m,S as c,B as p,J as f,Q as y,g,j as h,i as b,D as C,t as k,o as S,a5 as v,w as x,a6 as w}from"./@vue.23a4bd1a.js";import{r as T,s as E,_ as N}from"./index.ab904951.js";import"./element-plus.b44d97a8.js";import{f as O}from"./index.6efc7880.js";import{d as M}from"./public.9c1d8f39.js";import{a as P}from"./index.6a02aeaf.js";import{u as j}from"./vue-router.91336ba9.js";import{d as U}from"./index.d0e41a43.js";import"./BaseForm.bc55ad6b.js";import"./TempHtml.vue_vue&type=script&lang.67ba229f.js";import"./BaseTable.36f55649.js";import"./sortablejs.621e50ab.js";import"./vuex.c868d4e0.js";import"./lodash.d7ab6f48.js";import"./dayjs.bad04745.js";import"./element-resize-detector.5b0b5621.js";import"./batch-processor.94093b2a.js";import"./echarts.e8cef18b.js";import"./tslib.34a40861.js";import"./zrender.5bef55a0.js";import"./vue3-print-nb.eccf419a.js";import"./nprogress.8b4927f9.js";import"./axios.7b768d2b.js";import"./default-passive-events.74004992.js";import"./resize-observer-polyfill.d4249adb.js";import"./normalize-wheel.1d574cd1.js";import"./mitt.32ebca9f.js";import"./async-validator.1fa0d626.js";import"./@popperjs.192dcd39.js";import"./vue.6d04e91d.js";const F=()=>{const{status:e,allCategoryList:t,dict:i}=E.state.common;return t.map((e=>{e.value=e.categoryName,e.label=e.categoryName,e.children=e.list,e.children.map((e=>{e.value=e.name,e.label=e.name}))})),t},A=()=>{const{status:e,allCategoryList:t,dict:i}=E.state.common;if(i.length>0){return i.filter(((e,t)=>"category1"===e.key))[0].data.map((e=>({value:e.key,label:e.key})))}};function I(e,t){const i={inline:!0,labelWidth:"100px",hiddenNum:7,list:[{type:"INPUT",key:"name",placeholder:"编码/品名/助记码/条码",isEnter:!0},{type:"INPUT-REMOTE",key:"category1",placeholder:"商品类别"},{type:"CASCADER",key:"category2",placeholder:"商品分类",data:F()},{type:"INPUT",key:"isSpecial",placeholder:"含麻黄碱",hidden:!0},{type:"INPUT",key:"maintenanceType",placeholder:"养护类型",hidden:!0},{type:"INPUT",key:"isColdChain",placeholder:"冷链",hidden:!0},{type:"INPUT",key:"storageCondition",placeholder:"存储条件",hidden:!0},{type:"INPUT",key:"saleState",placeholder:"销售状态",hidden:!0},{type:"INPUT",key:"purchaseState",placeholder:"采购状态",hidden:!0},{type:"INPUT",key:"state",placeholder:"审核状态",hidden:!0}]},a={columns:[{type:"index",title:"序号",fixed:"left",width:50},{title:"商品编码",fixed:"left",key:"code",width:80},{title:"商品名称",fixed:"left",key:"productName",formConfig:{"min-width":210}},{title:"规格",key:"specification",width:100},{title:"单位",key:"unit",width:50},{title:"生产厂家",key:"manufacturer",width:120},{title:"零售价",key:"retailPrice",align:"right",width:100},{title:"会员价",key:"memberPrice",align:"right",width:100},{title:"加价支付标准",key:"drugMarkupPrice",align:"right",width:100,render:e=>e.drugMarkupPrice&&99999999!=e.drugMarkupPrice&&999999!=e.drugMarkupPrice&&99999!=e.drugMarkupPrice&&100000199!=e.drugMarkupPrice&&0!=e.drugMarkupPrice?e.drugMarkupPrice:"-"},{title:"商品分类",key:"category2",width:140},{title:"商品类别",key:"category1",width:140},{title:"批准文号",key:"approvalNumber",width:100},{title:"国家编码",key:"drugNationalCode",width:120},{title:"上市许可持有人",key:"holderPermit",width:120},{title:"含麻黄碱",key:"isSpecial",width:100,formConfig:{filters:[{text:"是",value:1},{text:"否",value:0}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",e.isSpecial?"是":"否")},{title:"养护类型",key:"maintenanceType",width:100,formConfig:{filters:[{text:"一般养护",value:"GENERAL_MAINTENANCE"},{text:"重点养护",value:"FOCUS_CONSERVATION"}]},render:(e,t,i,a)=>u("div",{GENERAL_MAINTENANCE:"一般养护",FOCUS_CONSERVATION:"重点养护"}[e.maintenanceType])},{title:"冷链",key:"isColdChain",width:60,formConfig:{filters:[{text:"是",value:1},{text:"否",value:0}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",e.isColdChain?"是":"否")},{title:"存储条件",key:"storageCondition",width:90,formConfig:{filters:[{text:"常温",value:"ROOM_TEMPERATURE"},{text:"阴凉",value:"COOL"},{text:"冷藏",value:"refrigeration"}]},render:(e,t,i,a)=>u("div",{ROOM_TEMPERATURE:"常温",COOL:"阴凉",refrigeration:"冷藏"}[e.storageCondition])},{title:"销售状态",key:"saleState",width:90,formConfig:{filters:[{text:"正常",value:"SUCCESS"},{text:"停销",value:"DISCONTINUED"}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",{innerHTML:{SUCCESS:"正常",DISCONTINUED:"停销"}[e.saleState]})},{title:"采购状态",key:"purchaseState",width:90,formConfig:{filters:[{text:"正常",value:"SUCCESS"},{text:"停购",value:"STOP"}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",{innerHTML:{SUCCESS:"正常",STOP:"停购"}[e.purchaseState]})},{title:"审核状态",key:"state",width:100,formConfig:{filters:[{text:"待提交",value:0},{text:"审核中",value:1},{text:"审核通过",value:2},{text:"审核拒绝",value:3}]},render:(e,t,i,a)=>u("div",{innerHTML:["待提交","审核中","审核通过","审核拒绝"][e.state]})},{title:"创建时间",key:"createTime",width:160},{title:"创建人",key:"creator",width:100},{title:"操作",key:"c",width:130,render:(e,i,a,o)=>[m(p("el-button"),{type:"text",onClick:t=>{l(t,"c",e)}},{default:()=>[c("查看")]}),f(m(p("el-button"),{type:"text",onClick:t=>{r(t,"c",e)}},{default:()=>[c("编辑")]}),[[y,2!==e.state]]),f(m(p("el-button"),{type:"text",class:"delete",onClick:i=>{M({msg:"确定删除该商品吗？",callback:async()=>{await O(e.uuid),t()}})}},{default:()=>[c("删除")]}),[[y,1!==e.state]])]}],columns1:[{type:"index",title:"序号",fixed:"left",width:50},{title:"商品编码",fixed:"left",key:"code",width:80},{title:"商品名称",fixed:"left",key:"productName",formConfig:{"min-width":210}},{title:"规格",key:"specification",width:100},{title:"单位",key:"unit",width:50},{title:"生产厂家",key:"manufacturer",width:120},{title:"参考零售价",key:"retailPrice",align:"right",width:100},{title:"参考会员价",key:"memberPrice",align:"right",width:100},{title:"加价支付标准",key:"drugMarkupPrice",align:"right",width:100,render:e=>e.drugMarkupPrice&&99999999!=e.drugMarkupPrice&&999999!=e.drugMarkupPrice&&99999!=e.drugMarkupPrice&&100000199!=e.drugMarkupPrice&&0!=e.drugMarkupPrice?e.drugMarkupPrice:"-"},{title:"商品分类",key:"category2",width:140},{title:"商品类别",key:"category1",width:140},{title:"批准文号",key:"approvalNumber",width:100},{title:"国家编码",key:"drugNationalCode",width:120},{title:"上市许可持有人",key:"holderPermit",width:120},{title:"含麻黄碱",key:"isSpecial",width:100,formConfig:{filters:[{text:"是",value:1},{text:"否",value:0}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",e.isSpecial?"是":"否")},{title:"养护类型",key:"maintenanceType",width:100,formConfig:{filters:[{text:"一般养护",value:"GENERAL_MAINTENANCE"},{text:"重点养护",value:"FOCUS_CONSERVATION"}]},render:(e,t,i,a)=>u("div",{GENERAL_MAINTENANCE:"一般养护",FOCUS_CONSERVATION:"重点养护"}[e.maintenanceType])},{title:"冷链",key:"isColdChain",width:60,formConfig:{filters:[{text:"是",value:1},{text:"否",value:0}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",e.isColdChain?"是":"否")},{title:"存储条件",key:"storageCondition",width:90,formConfig:{filters:[{text:"常温",value:"ROOM_TEMPERATURE"},{text:"阴凉",value:"COOL"},{text:"冷藏",value:"refrigeration"}]},render:(e,t,i,a)=>u("div",{ROOM_TEMPERATURE:"常温",COOL:"阴凉",refrigeration:"冷藏"}[e.storageCondition])},{title:"销售状态",key:"saleState",width:90,formConfig:{filters:[{text:"正常",value:"SUCCESS"},{text:"停销",value:"DISCONTINUED"}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",{innerHTML:{SUCCESS:"正常",DISCONTINUED:"停销"}[e.saleState]})},{title:"采购状态",key:"purchaseState",width:90,formConfig:{filters:[{text:"正常",value:"SUCCESS"},{text:"停购",value:"STOP"}],"filter-multiple":!1},render:(e,t,i,a)=>u("div",{innerHTML:{SUCCESS:"正常",STOP:"停购"}[e.purchaseState]})},{title:"审核状态",key:"state",width:100,formConfig:{filters:[{text:"待提交",value:0},{text:"审核中",value:1},{text:"审核通过",value:2},{text:"审核拒绝",value:3}]},render:(e,t,i,a)=>u("div",{innerHTML:["待提交","审核中","审核通过","审核拒绝"][e.state]})},{title:"创建时间",key:"createTime",width:160},{title:"创建人",key:"creator",width:100},{title:"操作",key:"c",width:130,render:(e,i,a,o)=>[m(p("el-button"),{type:"text",onClick:t=>{l(t,"c",e)}},{default:()=>[c("查看")]}),f(m(p("el-button"),{type:"text",onClick:t=>{r(t,"c",e)}},{default:()=>[c("编辑")]}),[[y,2!==e.state]]),f(m(p("el-button"),{type:"text",class:"delete",onClick:i=>{M({msg:"确定删除该商品吗？",callback:async()=>{await O(e.uuid),t()}})}},{default:()=>[c("删除")]}),[[y,1!==e.state]])]}],listData:{dict:A()}},r=(e,t,i)=>{T.push({name:"CommodityManageAddAndEdit",query:{uuid:i.uuid,state:"edit"}})},l=(e,t,i)=>{T.push({name:"CommodityManageAddAndEdit",query:{uuid:i.uuid,state:"see",type:i.state}})};return{form:i,tableConfig:a}}var R={name:"Goods",components:{BaseStencil:n},setup(e,t){const i=g(null),a=j(),r=h({excelUrl:"",tableData:[],openMultipleStores:"",columns:[],deepSearchTable:I(0,(()=>l())),submitForm:{"page.currentPage":1,"page.pageSize":10}}),l=async()=>{let e="";r.submitForm.category2&&r.submitForm.category2.length>1&&(e=r.submitForm.category2&&r.submitForm.category2.length>0?r.submitForm.category2[0]+"/"+r.submitForm.category2[1]:"");try{const t=await P(d(s({},r.submitForm),{category2:e,openMultipleStores:r.openMultipleStores}));r.submitForm.pageNumber=t.currentPage,r.tableData=t.list,r.submitForm.total=t.totalElements}catch(t){return t}};b([()=>r.submitForm.category1,()=>r.submitForm.category2],(([e,t],[i,a])=>{l()})),C((()=>{r.openMultipleStores=E.state.common.info.openMultipleStores,l(),U({name:"openMultipleStores"}).then((e=>{r.openMultipleStores=e.value,r.columns=r.openMultipleStores&&"0"!=r.openMultipleStores?r.deepSearchTable.tableConfig.columns1:r.deepSearchTable.tableConfig.columns}))}));return d(s({},k(r)),{commodityListData:l,axiosGetTemplate:function(){r.submitForm.name&&r.submitForm.name,r.submitForm.code&&r.submitForm.code,r.submitForm.category1&&r.submitForm.category1,r.submitForm.category2&&r.submitForm.category2,r.submitForm.state&&r.submitForm.state;let{storeUuid:e}=E.state.common.info;r.excelUrl="/gateway/chain-store/product/export/product.xls?storeUuid="+e;let t=["pageNumber","page.currentPage","page.pageSize","total"];for(let i in r.submitForm)if(-1===t.indexOf(i)){let e="";e="category2"==i?"&"+i+"="+(r.submitForm[i]?r.submitForm[i].join("/"):""):"&"+i+"="+(r.submitForm[i]?r.submitForm[i]:""),r.excelUrl+=e}},refTable:i,handleClick:({item:e,type:t})=>{"dblclick"===t&&a.push({name:"CommodityManageAddAndEdit",query:{uuid:e.uuid,state:"see",type:e.state}})}})}};const D={class:"supplier"},_={style:{"margin-left":"10px"}},L=["href"],G=c(" 导出 ");var z=N(R,[["render",function(e,t,i,a,r,l){const o=p("el-button"),s=n;return S(),v("div",D,[m(s,{ref:a.refTable,"submit-form":e.submitForm,"onUpdate:submit-form":t[0]||(t[0]=t=>e.submitForm=t),add:{path:"/commodity-manage/addAndEdit?state=add"},columns:e.columns,draggable:!1,"form-data":e.deepSearchTable.form,"option-show":!1,options:!0,otherData:e.deepSearchTable.tableConfig.listData,pagination:e.submitForm,select:a.commodityListData,"table-data":e.tableData,class:"base-stencil",onOnClick:a.handleClick},{buttons:x((()=>[w("span",_,[w("a",{href:e.excelUrl,download:"商品管理列表.xls"},[m(o,{clas:"export-btn",size:"small",onClick:a.axiosGetTemplate},{default:x((()=>[G])),_:1},8,["onClick"])],8,L)])])),_:1},8,["submit-form","columns","form-data","otherData","pagination","select","table-data","onOnClick"])])}],["__scopeId","data-v-a33853d8"]]);export{z as default};
